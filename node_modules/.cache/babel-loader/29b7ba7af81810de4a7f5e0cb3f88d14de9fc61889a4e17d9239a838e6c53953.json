{"ast":null,"code":"function other(p){return p===1?2:1;}export function startOfTurn(state,p){// Standard-Refresh: 2 AP pro Zug\nstate.actionPoints[p]=2;state.actionsUsed[p]=0;// Reset pro Runde\nstate.effectFlags[p].initiativeDiscount=0;state.effectFlags[p].initiativeRefund=0;state.effectFlags[p].govRefundAvailable=false;state.effectFlags[p].markZuckerbergUsed=false;// Cluster-3: temporÃ¤re Auren (namensbasiert, gelten fÃ¼r Sofort-Initiativen)\n// +1 Einfluss bei Sofort-Initiativen (eigener Spieler):\nconst publicNames=state.board[p].innen.map(c=>c.name);const oppPublic=state.board[other(p)].innen.map(c=>c.name);// Jennifer Doudna / Anthony Fauci  â†’ +1 kumulativ pro Karte\nconst plusSources=['Jennifer Doudna','Anthony Fauci'];const plusCount=publicNames.filter(n=>plusSources.includes(n)).length;state.effectFlags[p].initiativeInfluenceBonus=plusCount;// 0..2\n// Noam Chomsky â†’ Gegner bekommt -1 (wir speichern beim Besitzer)\nstate.effectFlags[p].initiativeInfluencePenaltyForOpponent=publicNames.includes('Noam Chomsky')?1:0;// Ai Weiwei â†’ Bei Sofort-Initiative: +1 Karte +1 AP\nstate.effectFlags[p].initiativeOnPlayDraw1Ap1=publicNames.includes('Ai Weiwei');// Bewegung (Greta/Malala) â†’ Government-Refund einmalig\nconst movement=['Greta Thunberg','Malala Yousafzai'];if(publicNames.some(n=>movement.includes(n))){state.effectFlags[p].govRefundAvailable=true;}// Fertig geloggt\nstate.log.push(\"\\uD83D\\uDD04 Start Zug P\".concat(p,\": Auren gesetzt (+\").concat(plusCount,\" | Gegner-Penalty=\").concat(state.effectFlags[p].initiativeInfluencePenaltyForOpponent,\")\"));}// Legacy compatibility\nexport function applyStartOfTurnFlags(state,player,log){startOfTurn(state,player);}export function applyStartOfTurnHooks(state,player,log){applyStartOfTurnFlags(state,player,log);}","map":{"version":3,"names":["other","p","startOfTurn","state","actionPoints","actionsUsed","effectFlags","initiativeDiscount","initiativeRefund","govRefundAvailable","markZuckerbergUsed","publicNames","board","innen","map","c","name","oppPublic","plusSources","plusCount","filter","n","includes","length","initiativeInfluenceBonus","initiativeInfluencePenaltyForOpponent","initiativeOnPlayDraw1Ap1","movement","some","log","push","concat","applyStartOfTurnFlags","player","applyStartOfTurnHooks"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/utils/startOfTurnHooks.ts"],"sourcesContent":["import { GameState, Player } from '../types/game';\r\n\r\nfunction other(p: Player): Player { return p === 1 ? 2 : 1; }\r\n\r\nexport function startOfTurn(state: GameState, p: Player) {\r\n  // Standard-Refresh: 2 AP pro Zug\r\n  state.actionPoints[p] = 2;\r\n  state.actionsUsed[p] = 0;\r\n\r\n  // Reset pro Runde\r\n  state.effectFlags[p].initiativeDiscount = 0;\r\n  state.effectFlags[p].initiativeRefund = 0;\r\n  state.effectFlags[p].govRefundAvailable = false;\r\n  state.effectFlags[p].markZuckerbergUsed = false;\r\n\r\n  // Cluster-3: temporÃ¤re Auren (namensbasiert, gelten fÃ¼r Sofort-Initiativen)\r\n  // +1 Einfluss bei Sofort-Initiativen (eigener Spieler):\r\n  const publicNames = state.board[p].innen.map(c => c.name);\r\n  const oppPublic   = state.board[other(p)].innen.map(c => c.name);\r\n\r\n  // Jennifer Doudna / Anthony Fauci  â†’ +1 kumulativ pro Karte\r\n  const plusSources = ['Jennifer Doudna', 'Anthony Fauci'];\r\n  const plusCount   = publicNames.filter(n => plusSources.includes(n)).length;\r\n  state.effectFlags[p].initiativeInfluenceBonus = plusCount; // 0..2\r\n\r\n  // Noam Chomsky â†’ Gegner bekommt -1 (wir speichern beim Besitzer)\r\n  state.effectFlags[p].initiativeInfluencePenaltyForOpponent =\r\n    publicNames.includes('Noam Chomsky') ? 1 : 0;\r\n\r\n  // Ai Weiwei â†’ Bei Sofort-Initiative: +1 Karte +1 AP\r\n  state.effectFlags[p].initiativeOnPlayDraw1Ap1 =\r\n    publicNames.includes('Ai Weiwei');\r\n\r\n  // Bewegung (Greta/Malala) â†’ Government-Refund einmalig\r\n  const movement = ['Greta Thunberg', 'Malala Yousafzai'];\r\n  if (publicNames.some(n => movement.includes(n))) {\r\n    state.effectFlags[p].govRefundAvailable = true;\r\n  }\r\n\r\n  // Fertig geloggt\r\n  state.log.push(`ðŸ”„ Start Zug P${p}: Auren gesetzt (+${plusCount} | Gegner-Penalty=${state.effectFlags[p].initiativeInfluencePenaltyForOpponent})`);\r\n}\r\n\r\n// Legacy compatibility\r\nexport function applyStartOfTurnFlags(state: GameState, player: Player, log: (m: string) => void) {\r\n  startOfTurn(state, player);\r\n}\r\n\r\nexport function applyStartOfTurnHooks(state: GameState, player: Player, log: (m: string) => void) {\r\n  applyStartOfTurnFlags(state, player, log);\r\n}"],"mappings":"AAEA,QAAS,CAAAA,KAAKA,CAACC,CAAS,CAAU,CAAE,MAAO,CAAAA,CAAC,GAAK,CAAC,CAAG,CAAC,CAAG,CAAC,CAAE,CAE5D,MAAO,SAAS,CAAAC,WAAWA,CAACC,KAAgB,CAAEF,CAAS,CAAE,CACvD;AACAE,KAAK,CAACC,YAAY,CAACH,CAAC,CAAC,CAAG,CAAC,CACzBE,KAAK,CAACE,WAAW,CAACJ,CAAC,CAAC,CAAG,CAAC,CAExB;AACAE,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACM,kBAAkB,CAAG,CAAC,CAC3CJ,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACO,gBAAgB,CAAG,CAAC,CACzCL,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACQ,kBAAkB,CAAG,KAAK,CAC/CN,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACS,kBAAkB,CAAG,KAAK,CAE/C;AACA;AACA,KAAM,CAAAC,WAAW,CAAGR,KAAK,CAACS,KAAK,CAACX,CAAC,CAAC,CAACY,KAAK,CAACC,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACC,IAAI,CAAC,CACzD,KAAM,CAAAC,SAAS,CAAKd,KAAK,CAACS,KAAK,CAACZ,KAAK,CAACC,CAAC,CAAC,CAAC,CAACY,KAAK,CAACC,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACC,IAAI,CAAC,CAEhE;AACA,KAAM,CAAAE,WAAW,CAAG,CAAC,iBAAiB,CAAE,eAAe,CAAC,CACxD,KAAM,CAAAC,SAAS,CAAKR,WAAW,CAACS,MAAM,CAACC,CAAC,EAAIH,WAAW,CAACI,QAAQ,CAACD,CAAC,CAAC,CAAC,CAACE,MAAM,CAC3EpB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACuB,wBAAwB,CAAGL,SAAS,CAAE;AAE3D;AACAhB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACwB,qCAAqC,CACxDd,WAAW,CAACW,QAAQ,CAAC,cAAc,CAAC,CAAG,CAAC,CAAG,CAAC,CAE9C;AACAnB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACyB,wBAAwB,CAC3Cf,WAAW,CAACW,QAAQ,CAAC,WAAW,CAAC,CAEnC;AACA,KAAM,CAAAK,QAAQ,CAAG,CAAC,gBAAgB,CAAE,kBAAkB,CAAC,CACvD,GAAIhB,WAAW,CAACiB,IAAI,CAACP,CAAC,EAAIM,QAAQ,CAACL,QAAQ,CAACD,CAAC,CAAC,CAAC,CAAE,CAC/ClB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACQ,kBAAkB,CAAG,IAAI,CAChD,CAEA;AACAN,KAAK,CAAC0B,GAAG,CAACC,IAAI,4BAAAC,MAAA,CAAkB9B,CAAC,uBAAA8B,MAAA,CAAqBZ,SAAS,uBAAAY,MAAA,CAAqB5B,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACwB,qCAAqC,KAAG,CAAC,CACpJ,CAEA;AACA,MAAO,SAAS,CAAAO,qBAAqBA,CAAC7B,KAAgB,CAAE8B,MAAc,CAAEJ,GAAwB,CAAE,CAChG3B,WAAW,CAACC,KAAK,CAAE8B,MAAM,CAAC,CAC5B,CAEA,MAAO,SAAS,CAAAC,qBAAqBA,CAAC/B,KAAgB,CAAE8B,MAAc,CAAEJ,GAAwB,CAAE,CAChGG,qBAAqB,CAAC7B,KAAK,CAAE8B,MAAM,CAAEJ,GAAG,CAAC,CAC3C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}