{"ast":null,"code":"import{isInstantInitiative}from'../utils/tags';// Helper: Spieler wechseln\nconst other=p=>p===1?2:1;export function recomputeAuraFlags(state){// Legacy aura flags removed - auras are now calculated on-demand via Board-Check\n// No more direct flag mutations - everything is event-driven\n// Government refund is now handled via events in the card activation flow\n// No need to pre-compute flags\n}/**\r\n * Wendet Einfluss-Modifikationen für Sofort-Initiativen an\r\n * Nur für Sofort-Initiativen, keine Topics/Tags\r\n */export function applyInstantInitiativeInfluenceMods(state,player,baseInfluence,card){var _state$board$player,_state$board$opponent;let influence=baseInfluence;const reasons=[];// Nur für Sofort-Initiativen\nif(!isInstantInitiative(card)){return{influence,reasons};}// Aura effects are now calculated on-demand via Board-Check\n// No more flag-based aura calculations - everything is event-driven\nconst publicCards=((_state$board$player=state.board[player])===null||_state$board$player===void 0?void 0:_state$board$player.innen)||[];// Jennifer Doudna: +1 Einfluss (on-demand check)\nconst jenniferDoudna=publicCards.find(card=>card.kind==='spec'&&card.name==='Jennifer Doudna'&&!card.deactivated);if(jenniferDoudna){influence+=1;reasons.push('Jennifer Doudna: +1 Einfluss');}// Anthony Fauci: +1 Einfluss (on-demand check)\nconst anthonyFauci=publicCards.find(card=>card.kind==='spec'&&card.name==='Anthony Fauci'&&!card.deactivated);if(anthonyFauci){influence+=1;reasons.push('Anthony Fauci: +1 Einfluss');}// Noam Chomsky: -1 Einfluss (on-demand check for opponent)\nconst opponent=player===1?2:1;const opponentCards=((_state$board$opponent=state.board[opponent])===null||_state$board$opponent===void 0?void 0:_state$board$opponent.innen)||[];const noamChomsky=opponentCards.find(card=>card.kind==='spec'&&card.name==='Noam Chomsky'&&!card.deactivated);if(noamChomsky){influence-=1;reasons.push('Noam Chomsky: −1 Einfluss');}return{influence,reasons};}/**\r\n * Ai Weiwei: +1 Karte +1 AP bei jeder Sofort-Initiative (AP cap bei 4)\r\n * DEPRECATED: This function is no longer used - Ai Weiwei effects are now handled via INITIATIVE_ACTIVATED events\r\n */export function maybeApplyAiWeiweiInstantBonus(state,player,card,log){// This function is deprecated - Ai Weiwei effects are now handled via INITIATIVE_ACTIVATED events\n// No more direct state mutations - everything is event-driven\nlog('DEPRECATED: Ai Weiwei effect now handled via INITIATIVE_ACTIVATED events');}","map":{"version":3,"names":["isInstantInitiative","other","p","recomputeAuraFlags","state","applyInstantInitiativeInfluenceMods","player","baseInfluence","card","_state$board$player","_state$board$opponent","influence","reasons","publicCards","board","innen","jenniferDoudna","find","kind","name","deactivated","push","anthonyFauci","opponent","opponentCards","noamChomsky","maybeApplyAiWeiweiInstantBonus","log"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/state/effects.ts"],"sourcesContent":["import { GameState, Player, Card } from '../types/game';\r\nimport { isInstantInitiative } from '../utils/tags';\r\n\r\n// Helper: Spieler wechseln\r\nconst other = (p: Player): Player => (p === 1 ? 2 : 1) as Player;\r\n\r\nexport function recomputeAuraFlags(state: GameState) {\r\n  // Legacy aura flags removed - auras are now calculated on-demand via Board-Check\r\n  // No more direct flag mutations - everything is event-driven\r\n\r\n  // Government refund is now handled via events in the card activation flow\r\n  // No need to pre-compute flags\r\n}\r\n\r\n/**\r\n * Wendet Einfluss-Modifikationen für Sofort-Initiativen an\r\n * Nur für Sofort-Initiativen, keine Topics/Tags\r\n */\r\nexport function applyInstantInitiativeInfluenceMods(\r\n  state: GameState,\r\n  player: Player,\r\n  baseInfluence: number,\r\n  card: Card\r\n): { influence: number; reasons: string[] } {\r\n  let influence = baseInfluence;\r\n  const reasons: string[] = [];\r\n\r\n  // Nur für Sofort-Initiativen\r\n  if (!isInstantInitiative(card)) {\r\n    return { influence, reasons };\r\n  }\r\n\r\n  // Aura effects are now calculated on-demand via Board-Check\r\n  // No more flag-based aura calculations - everything is event-driven\r\n\r\n  const publicCards = state.board[player]?.innen || [];\r\n\r\n  // Jennifer Doudna: +1 Einfluss (on-demand check)\r\n  const jenniferDoudna = publicCards.find(card =>\r\n    card.kind === 'spec' && (card as any).name === 'Jennifer Doudna' && !(card as any).deactivated\r\n  );\r\n  if (jenniferDoudna) {\r\n    influence += 1;\r\n    reasons.push('Jennifer Doudna: +1 Einfluss');\r\n  }\r\n\r\n  // Anthony Fauci: +1 Einfluss (on-demand check)\r\n  const anthonyFauci = publicCards.find(card =>\r\n    card.kind === 'spec' && (card as any).name === 'Anthony Fauci' && !(card as any).deactivated\r\n  );\r\n  if (anthonyFauci) {\r\n    influence += 1;\r\n    reasons.push('Anthony Fauci: +1 Einfluss');\r\n  }\r\n\r\n  // Noam Chomsky: -1 Einfluss (on-demand check for opponent)\r\n  const opponent = player === 1 ? 2 : 1;\r\n  const opponentCards = state.board[opponent]?.innen || [];\r\n  const noamChomsky = opponentCards.find(card =>\r\n    card.kind === 'spec' && (card as any).name === 'Noam Chomsky' && !(card as any).deactivated\r\n  );\r\n  if (noamChomsky) {\r\n    influence -= 1;\r\n    reasons.push('Noam Chomsky: −1 Einfluss');\r\n  }\r\n\r\n  return { influence, reasons };\r\n}\r\n\r\n/**\r\n * Ai Weiwei: +1 Karte +1 AP bei jeder Sofort-Initiative (AP cap bei 4)\r\n * DEPRECATED: This function is no longer used - Ai Weiwei effects are now handled via INITIATIVE_ACTIVATED events\r\n */\r\nexport function maybeApplyAiWeiweiInstantBonus(\r\n  state: GameState,\r\n  player: Player,\r\n  card: Card,\r\n  log: (s: string) => void\r\n): void {\r\n  // This function is deprecated - Ai Weiwei effects are now handled via INITIATIVE_ACTIVATED events\r\n  // No more direct state mutations - everything is event-driven\r\n  log('DEPRECATED: Ai Weiwei effect now handled via INITIATIVE_ACTIVATED events');\r\n}\r\n\r\n"],"mappings":"AACA,OAASA,mBAAmB,KAAQ,eAAe,CAEnD;AACA,KAAM,CAAAC,KAAK,CAAIC,CAAS,EAAcA,CAAC,GAAK,CAAC,CAAG,CAAC,CAAG,CAAY,CAEhE,MAAO,SAAS,CAAAC,kBAAkBA,CAACC,KAAgB,CAAE,CACnD;AACA;AAEA;AACA;AAAA,CAGF;AACA;AACA;AACA,GACA,MAAO,SAAS,CAAAC,mCAAmCA,CACjDD,KAAgB,CAChBE,MAAc,CACdC,aAAqB,CACrBC,IAAU,CACgC,KAAAC,mBAAA,CAAAC,qBAAA,CAC1C,GAAI,CAAAC,SAAS,CAAGJ,aAAa,CAC7B,KAAM,CAAAK,OAAiB,CAAG,EAAE,CAE5B;AACA,GAAI,CAACZ,mBAAmB,CAACQ,IAAI,CAAC,CAAE,CAC9B,MAAO,CAAEG,SAAS,CAAEC,OAAQ,CAAC,CAC/B,CAEA;AACA;AAEA,KAAM,CAAAC,WAAW,CAAG,EAAAJ,mBAAA,CAAAL,KAAK,CAACU,KAAK,CAACR,MAAM,CAAC,UAAAG,mBAAA,iBAAnBA,mBAAA,CAAqBM,KAAK,GAAI,EAAE,CAEpD;AACA,KAAM,CAAAC,cAAc,CAAGH,WAAW,CAACI,IAAI,CAACT,IAAI,EAC1CA,IAAI,CAACU,IAAI,GAAK,MAAM,EAAKV,IAAI,CAASW,IAAI,GAAK,iBAAiB,EAAI,CAAEX,IAAI,CAASY,WACrF,CAAC,CACD,GAAIJ,cAAc,CAAE,CAClBL,SAAS,EAAI,CAAC,CACdC,OAAO,CAACS,IAAI,CAAC,8BAA8B,CAAC,CAC9C,CAEA;AACA,KAAM,CAAAC,YAAY,CAAGT,WAAW,CAACI,IAAI,CAACT,IAAI,EACxCA,IAAI,CAACU,IAAI,GAAK,MAAM,EAAKV,IAAI,CAASW,IAAI,GAAK,eAAe,EAAI,CAAEX,IAAI,CAASY,WACnF,CAAC,CACD,GAAIE,YAAY,CAAE,CAChBX,SAAS,EAAI,CAAC,CACdC,OAAO,CAACS,IAAI,CAAC,4BAA4B,CAAC,CAC5C,CAEA;AACA,KAAM,CAAAE,QAAQ,CAAGjB,MAAM,GAAK,CAAC,CAAG,CAAC,CAAG,CAAC,CACrC,KAAM,CAAAkB,aAAa,CAAG,EAAAd,qBAAA,CAAAN,KAAK,CAACU,KAAK,CAACS,QAAQ,CAAC,UAAAb,qBAAA,iBAArBA,qBAAA,CAAuBK,KAAK,GAAI,EAAE,CACxD,KAAM,CAAAU,WAAW,CAAGD,aAAa,CAACP,IAAI,CAACT,IAAI,EACzCA,IAAI,CAACU,IAAI,GAAK,MAAM,EAAKV,IAAI,CAASW,IAAI,GAAK,cAAc,EAAI,CAAEX,IAAI,CAASY,WAClF,CAAC,CACD,GAAIK,WAAW,CAAE,CACfd,SAAS,EAAI,CAAC,CACdC,OAAO,CAACS,IAAI,CAAC,2BAA2B,CAAC,CAC3C,CAEA,MAAO,CAAEV,SAAS,CAAEC,OAAQ,CAAC,CAC/B,CAEA;AACA;AACA;AACA,GACA,MAAO,SAAS,CAAAc,8BAA8BA,CAC5CtB,KAAgB,CAChBE,MAAc,CACdE,IAAU,CACVmB,GAAwB,CAClB,CACN;AACA;AACAA,GAAG,CAAC,0EAA0E,CAAC,CACjF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}