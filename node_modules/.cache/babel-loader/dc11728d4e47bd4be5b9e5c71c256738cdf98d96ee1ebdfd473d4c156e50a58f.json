{"ast":null,"code":"import{isInstantInitiative}from'../utils/tags';// Helper: Spieler wechseln\nconst other=p=>p===1?2:1;export function recomputeAuraFlags(state){for(const p of[1,2]){const f=state.effectFlags[p];f.scienceInitiativeBonus=false;// Jennifer Doudna: +1 influence on instant initiatives\nf.healthInitiativeBonus=false;// Anthony Fauci: +1 influence on instant initiatives\nf.cultureInitiativeBonus=false;// Ai Weiwei: +1 card +1 AP on instant initiatives\nf.militaryInitiativePenalty=false;// Noam Chomsky: -1 influence on opponent instant initiatives\n// Movement refund is per turn; leave whatever your start-of-turn sets\n// f.govRefundAvailable is managed at turn start\n}for(const p of[1,2]){const pub=state.board[p].innen;const has=name=>pub.some(c=>c.name===name&&!c.deactivated);if(has('Jennifer Doudna'))state.effectFlags[p].scienceInitiativeBonus=true;if(has('Anthony Fauci'))state.effectFlags[p].healthInitiativeBonus=true;if(has('Ai Weiwei'))state.effectFlags[p].cultureInitiativeBonus=true;if(has('Noam Chomsky'))state.effectFlags[p===1?2:1].militaryInitiativePenalty=true;if(pub.some(c=>['Greta Thunberg','Malala Yousafzai','Ai Weiwei','Alexei Navalny'].includes(c.name)&&!c.deactivated)){state.effectFlags[p].govRefundAvailable=true;// movement â†’ first gov card refund\n}}}/**\r\n * Wendet Einfluss-Modifikationen fÃ¼r Sofort-Initiativen an\r\n * Nur fÃ¼r Sofort-Initiativen, keine Topics/Tags\r\n */export function applyInstantInitiativeInfluenceMods(state,player,baseInfluence,card){var _state$effectFlags$pl,_state$effectFlags$pl2,_state$effectFlags$pl3;let influence=baseInfluence;const reasons=[];// Nur fÃ¼r Sofort-Initiativen\nif(!isInstantInitiative(card)){return{influence,reasons};}// Jennifer Doudna: +1 Einfluss\nif((_state$effectFlags$pl=state.effectFlags[player])!==null&&_state$effectFlags$pl!==void 0&&_state$effectFlags$pl.scienceInitiativeBonus){influence+=1;reasons.push('Jennifer Doudna: +1 Einfluss');}// Anthony Fauci: +1 Einfluss\nif((_state$effectFlags$pl2=state.effectFlags[player])!==null&&_state$effectFlags$pl2!==void 0&&_state$effectFlags$pl2.healthInitiativeBonus){influence+=1;reasons.push('Anthony Fauci: +1 Einfluss');}// Noam Chomsky: -1 Einfluss (fÃ¼r den Spieler mit der Aura)\nif((_state$effectFlags$pl3=state.effectFlags[player])!==null&&_state$effectFlags$pl3!==void 0&&_state$effectFlags$pl3.militaryInitiativePenalty){influence-=1;reasons.push('Noam Chomsky: âˆ’1 Einfluss');}return{influence,reasons};}/**\r\n * Ai Weiwei: +1 Karte +1 AP bei jeder Sofort-Initiative (AP cap bei 4)\r\n */export function maybeApplyAiWeiweiInstantBonus(state,player,card,log){var _state$effectFlags$pl4;// Nur fÃ¼r Sofort-Initiativen\nif(!isInstantInitiative(card))return;// Nur wenn Ai Weiwei in der Ã–ffentlichkeit ist\nif(!((_state$effectFlags$pl4=state.effectFlags[player])!==null&&_state$effectFlags$pl4!==void 0&&_state$effectFlags$pl4.cultureInitiativeBonus))return;// +1 Karte ziehen (falls Deck nicht leer)\nconst drawn=state.decks[player].shift();if(drawn){state.hands[player].push(drawn);log(\"\\uD83D\\uDD25 Ai Weiwei: +1 Karte gezogen (\".concat(drawn.name,\")\"));}// +1 AP (mit Cap bei 4)\nconst before=state.actionPoints[player];state.actionPoints[player]=before+1;if(before!==state.actionPoints[player]){log(\"\\uD83D\\uDD25 Ai Weiwei: +1 AP (\".concat(before,\"\\u2192\").concat(state.actionPoints[player],\")\"));}}","map":{"version":3,"names":["isInstantInitiative","other","p","recomputeAuraFlags","state","f","effectFlags","scienceInitiativeBonus","healthInitiativeBonus","cultureInitiativeBonus","militaryInitiativePenalty","pub","board","innen","has","name","some","c","deactivated","includes","govRefundAvailable","applyInstantInitiativeInfluenceMods","player","baseInfluence","card","_state$effectFlags$pl","_state$effectFlags$pl2","_state$effectFlags$pl3","influence","reasons","push","maybeApplyAiWeiweiInstantBonus","log","_state$effectFlags$pl4","drawn","decks","shift","hands","concat","before","actionPoints"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/state/effects.ts"],"sourcesContent":["import { GameState, Player, Card } from '../types/game';\r\nimport { isInstantInitiative } from '../utils/tags';\r\n\r\n// Helper: Spieler wechseln\r\nconst other = (p: Player): Player => (p === 1 ? 2 : 1) as Player;\r\n\r\nexport function recomputeAuraFlags(state: GameState) {\r\n  for (const p of [1, 2] as const) {\r\n    const f = state.effectFlags[p];\r\n    f.scienceInitiativeBonus    = false; // Jennifer Doudna: +1 influence on instant initiatives\r\n    f.healthInitiativeBonus     = false; // Anthony Fauci: +1 influence on instant initiatives\r\n    f.cultureInitiativeBonus    = false; // Ai Weiwei: +1 card +1 AP on instant initiatives\r\n    f.militaryInitiativePenalty = false; // Noam Chomsky: -1 influence on opponent instant initiatives\r\n    // Movement refund is per turn; leave whatever your start-of-turn sets\r\n    // f.govRefundAvailable is managed at turn start\r\n  }\r\n\r\n  for (const p of [1, 2] as const) {\r\n    const pub = state.board[p].innen;\r\n\r\n    const has = (name: string) =>\r\n      pub.some(c => (c as any).name === name && !(c as any).deactivated);\r\n\r\n    if (has('Jennifer Doudna')) state.effectFlags[p].scienceInitiativeBonus = true;\r\n    if (has('Anthony Fauci'))   state.effectFlags[p].healthInitiativeBonus  = true;\r\n    if (has('Ai Weiwei'))       state.effectFlags[p].cultureInitiativeBonus = true;\r\n    if (has('Noam Chomsky'))    state.effectFlags[p === 1 ? 2 : 1].militaryInitiativePenalty = true;\r\n\r\n    if (pub.some(c => ['Greta Thunberg','Malala Yousafzai','Ai Weiwei','Alexei Navalny']\r\n        .includes((c as any).name) && !(c as any).deactivated)) {\r\n      state.effectFlags[p].govRefundAvailable = true; // movement â†’ first gov card refund\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Wendet Einfluss-Modifikationen fÃ¼r Sofort-Initiativen an\r\n * Nur fÃ¼r Sofort-Initiativen, keine Topics/Tags\r\n */\r\nexport function applyInstantInitiativeInfluenceMods(\r\n  state: GameState,\r\n  player: Player,\r\n  baseInfluence: number,\r\n  card: Card\r\n): { influence: number; reasons: string[] } {\r\n  let influence = baseInfluence;\r\n  const reasons: string[] = [];\r\n\r\n  // Nur fÃ¼r Sofort-Initiativen\r\n  if (!isInstantInitiative(card)) {\r\n    return { influence, reasons };\r\n  }\r\n\r\n  // Jennifer Doudna: +1 Einfluss\r\n  if (state.effectFlags[player]?.scienceInitiativeBonus) {\r\n    influence += 1;\r\n    reasons.push('Jennifer Doudna: +1 Einfluss');\r\n  }\r\n\r\n  // Anthony Fauci: +1 Einfluss\r\n  if (state.effectFlags[player]?.healthInitiativeBonus) {\r\n    influence += 1;\r\n    reasons.push('Anthony Fauci: +1 Einfluss');\r\n  }\r\n\r\n  // Noam Chomsky: -1 Einfluss (fÃ¼r den Spieler mit der Aura)\r\n  if (state.effectFlags[player]?.militaryInitiativePenalty) {\r\n    influence -= 1;\r\n    reasons.push('Noam Chomsky: âˆ’1 Einfluss');\r\n  }\r\n\r\n  return { influence, reasons };\r\n}\r\n\r\n/**\r\n * Ai Weiwei: +1 Karte +1 AP bei jeder Sofort-Initiative (AP cap bei 4)\r\n */\r\nexport function maybeApplyAiWeiweiInstantBonus(\r\n  state: GameState,\r\n  player: Player,\r\n  card: Card,\r\n  log: (s: string) => void\r\n): void {\r\n  // Nur fÃ¼r Sofort-Initiativen\r\n  if (!isInstantInitiative(card)) return;\r\n\r\n  // Nur wenn Ai Weiwei in der Ã–ffentlichkeit ist\r\n  if (!state.effectFlags[player]?.cultureInitiativeBonus) return;\r\n\r\n  // +1 Karte ziehen (falls Deck nicht leer)\r\n  const drawn = state.decks[player].shift();\r\n  if (drawn) {\r\n    state.hands[player].push(drawn);\r\n    log(`ðŸ”¥ Ai Weiwei: +1 Karte gezogen (${drawn.name})`);\r\n  }\r\n\r\n  // +1 AP (mit Cap bei 4)\r\n  const before = state.actionPoints[player];\r\n  state.actionPoints[player] = before + 1;\r\n\r\n  if (before !== state.actionPoints[player]) {\r\n    log(`ðŸ”¥ Ai Weiwei: +1 AP (${before}â†’${state.actionPoints[player]})`);\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}