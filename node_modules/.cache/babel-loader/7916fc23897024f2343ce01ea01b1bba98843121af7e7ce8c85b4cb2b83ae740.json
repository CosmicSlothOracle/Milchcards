{"ast":null,"code":"function other(p) {\n  return p === 1 ? 2 : 1;\n}\nexport function startOfTurn(state, p) {\n  var _state$board$p$innen, _state$board$p, _state$board$p$aussen, _state$board$p2;\n  // AP reset\n  state.actionPoints[p] = 2;\n\n  // Flags reset\n  const f = state.effectFlags[p];\n  // Flags reset\n  const prevZuck = f.zuckSpent;\n  f.zuckOnceAp = false;\n  f.zuckSpent = false;\n  f.aiWeiweiOnActivate = false;\n  f.auraScience = 0;\n  f.auraHealth = 0;\n  f.auraMilitaryPenalty = 0;\n  // Oppositionsblockade ends at start of player's turn\n  f.initiativesLocked = false;\n  // Simplified AP system: No initiative-specific bonuses\n\n  // Helper to consume double aura flag once\n  const consumeDouble = () => {\n    if (f.doublePublicAura) {\n      f.doublePublicAura = false;\n      if (!state._effectQueue) state._effectQueue = [];\n      state._effectQueue.push({\n        type: 'LOG',\n        msg: 'Double Public Aura consumed.'\n      });\n      return true;\n    }\n    return false;\n  };\n\n  // Determine active public cards (inner lane)\n  const pubNames = ((_state$board$p$innen = (_state$board$p = state.board[p]) === null || _state$board$p === void 0 ? void 0 : _state$board$p.innen) !== null && _state$board$p$innen !== void 0 ? _state$board$p$innen : []).map(c => c.name);\n\n  // Apply auras with possible doubling (consume order defined)\n  if (pubNames.includes('Jennifer Doudna')) {\n    var _f$auraScience;\n    const doubled = consumeDouble();\n    f.auraScience = ((_f$auraScience = f.auraScience) !== null && _f$auraScience !== void 0 ? _f$auraScience : 0) + (doubled ? 2 : 1);\n  }\n  if (pubNames.includes('Anthony Fauci')) {\n    var _f$auraHealth;\n    const doubled = consumeDouble();\n    f.auraHealth = ((_f$auraHealth = f.auraHealth) !== null && _f$auraHealth !== void 0 ? _f$auraHealth : 0) + (doubled ? 2 : 1);\n  }\n  if (pubNames.includes('Noam Chomsky')) {\n    var _f$auraMilitaryPenalt;\n    const doubled = consumeDouble();\n    f.auraMilitaryPenalty = ((_f$auraMilitaryPenalt = f.auraMilitaryPenalty) !== null && _f$auraMilitaryPenalt !== void 0 ? _f$auraMilitaryPenalt : 0) + (doubled ? 2 : 1);\n  }\n\n  // Mark Zuckerberg und Ai Weiwei werden jetzt über Queue-Events gehandhabt\n  // Keine Flag-Setzung mehr nötig\n\n  // Leadership effect: +1 AP immediately\n  const govNames = ((_state$board$p$aussen = (_state$board$p2 = state.board[p]) === null || _state$board$p2 === void 0 ? void 0 : _state$board$p2.aussen) !== null && _state$board$p$aussen !== void 0 ? _state$board$p$aussen : []).map(c => c.name);\n  if (govNames.some(name => ['Justin Trudeau', 'Volodymyr Zelenskyy', 'Ursula von der Leyen', 'Donald Trump', 'Mohammed bin Salman', 'Benjamin Netanyahu', 'Helmut Schmidt'].includes(name))) {\n    // Simplified AP system: Leadership gives +1 AP immediately\n    state.actionPoints[p] += 1;\n  }\n}\n\n// Legacy compatibility\nexport function applyStartOfTurnFlags(state, player, log) {\n  startOfTurn(state, player);\n}\nexport function applyStartOfTurnHooks(state, player, log) {\n  applyStartOfTurnFlags(state, player, log);\n}","map":{"version":3,"names":["other","p","startOfTurn","state","_state$board$p$innen","_state$board$p","_state$board$p$aussen","_state$board$p2","actionPoints","f","effectFlags","prevZuck","zuckSpent","zuckOnceAp","aiWeiweiOnActivate","auraScience","auraHealth","auraMilitaryPenalty","initiativesLocked","consumeDouble","doublePublicAura","_effectQueue","push","type","msg","pubNames","board","innen","map","c","name","includes","_f$auraScience","doubled","_f$auraHealth","_f$auraMilitaryPenalt","govNames","aussen","some","applyStartOfTurnFlags","player","log","applyStartOfTurnHooks"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/utils/startOfTurnHooks.ts"],"sourcesContent":["import { GameState, Player } from '../types/game';\n\nfunction other(p: Player): Player { return p === 1 ? 2 : 1; }\n\nexport function startOfTurn(state: GameState, p: Player) {\n  // AP reset\n  state.actionPoints[p] = 2;\n\n  // Flags reset\n  const f = state.effectFlags[p];\n  // Flags reset\n  const prevZuck = f.zuckSpent;\n  f.zuckOnceAp = false;\n  f.zuckSpent = false;\n  f.aiWeiweiOnActivate = false;\n  f.auraScience = 0;\n  f.auraHealth = 0;\n  f.auraMilitaryPenalty = 0;\n  // Oppositionsblockade ends at start of player's turn\n  f.initiativesLocked = false;\n  // Simplified AP system: No initiative-specific bonuses\n\n  // Helper to consume double aura flag once\n  const consumeDouble = (): boolean => {\n    if (f.doublePublicAura) {\n      f.doublePublicAura = false;\n      if (!state._effectQueue) state._effectQueue = [];\n      state._effectQueue.push({ type: 'LOG', msg: 'Double Public Aura consumed.' } as any);\n      return true;\n    }\n    return false;\n  };\n\n  // Determine active public cards (inner lane)\n  const pubNames: string[] = (state.board[p]?.innen ?? []).map(c => c.name);\n\n  // Apply auras with possible doubling (consume order defined)\n  if (pubNames.includes('Jennifer Doudna')) {\n    const doubled = consumeDouble();\n    f.auraScience = (f.auraScience ?? 0) + (doubled ? 2 : 1);\n  }\n  if (pubNames.includes('Anthony Fauci')) {\n    const doubled = consumeDouble();\n    f.auraHealth = (f.auraHealth ?? 0) + (doubled ? 2 : 1);\n  }\n  if (pubNames.includes('Noam Chomsky')) {\n    const doubled = consumeDouble();\n    f.auraMilitaryPenalty = (f.auraMilitaryPenalty ?? 0) + (doubled ? 2 : 1);\n  }\n\n  // Mark Zuckerberg und Ai Weiwei werden jetzt über Queue-Events gehandhabt\n  // Keine Flag-Setzung mehr nötig\n\n  // Leadership effect: +1 AP immediately\n  const govNames: string[] = (state.board[p]?.aussen ?? []).map((c: any) => c.name);\n  if (govNames.some(name => ['Justin Trudeau', 'Volodymyr Zelenskyy', 'Ursula von der Leyen', 'Donald Trump', 'Mohammed bin Salman', 'Benjamin Netanyahu', 'Helmut Schmidt'].includes(name))) {\n    // Simplified AP system: Leadership gives +1 AP immediately\n    state.actionPoints[p] += 1;\n  }\n}\n\n// Legacy compatibility\nexport function applyStartOfTurnFlags(state: GameState, player: Player, log: (m: string) => void) {\n  startOfTurn(state, player);\n}\n\nexport function applyStartOfTurnHooks(state: GameState, player: Player, log: (m: string) => void) {\n  applyStartOfTurnFlags(state, player, log);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}