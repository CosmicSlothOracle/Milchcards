{"ast":null,"code":"import{getStrongestGovernment}from'./targets';import{registerTrap}from'./traps';import{logAP,logDraw,logDiscardRandom,logDeactivateRandom,logBuffStrongest,logShield,logDeactivateCard,logOpportunist}from'./logs';import{getGlobalRNG}from'../services/rng';// Helper function to check if a government card is authoritarian\nfunction isAuthoritarianGovernment(card){// Authoritarian governments: Putin, Xi Jinping, Erdogan, etc.\nconst authoritarianNames=['Vladimir Putin','Xi Jinping','Recep Tayyip Erdogan','Kim Jong-un','Bashar al-Assad','Alexander Lukashenko','Nicolás Maduro','Daniel Ortega'];return authoritarianNames.includes(card.name);}// Helper to find strongest government uid for new intents\nfunction strongestGovernmentUid(state,p){var _state$board$p;const govRow=(_state$board$p=state.board[p])===null||_state$board$p===void 0?void 0:_state$board$p.aussen;if(!govRow||govRow.length===0)return null;const alive=govRow.filter(g=>!g.deactivated);if(!alive.length)return null;const sorted=alive.slice().sort((a,b)=>b.influence+(b.tempBuffs||0)-(b.tempDebuffs||0)-(a.influence+(a.tempBuffs||0)-(a.tempDebuffs||0)));return sorted[0].uid;}function other(p){return p===1?2:1;}function logPush(state,msg){state.log.push(msg);}function strongestGov(state,p){const row=state.board[p].aussen;if(!row.length)return null;const alive=row.filter(c=>!c.deactivated);if(alive.length===0)return null;return alive.slice().sort((a,b)=>b.influence+(b.tempBuffs||0)-(b.tempDebuffs||0)-(a.influence+(a.tempBuffs||0)-(a.tempDebuffs||0)))[0];}function publicNames(state,p){return state.board[p].innen.map(c=>c.name);}function hasPublic(state,p,name){return publicNames(state,p).includes(name);}function findCardByUidOnBoard(state,uid){for(const p of[1,2]){for(const lane of['innen','aussen','sofort']){const arr=state.board[p][lane];const hit=arr.find(c=>c.uid===uid);if(hit)return hit;}}return null;}export function resolveQueue(state,events){const rng=getGlobalRNG();// Single pass FIFO\nwhile(events.length){const ev=events.shift();switch(ev.type){case'LOG':{logPush(state,ev.msg);break;}case'ADD_AP':{const cur=state.actionPoints[ev.player];const next=Math.max(0,cur+ev.amount);state.actionPoints[ev.player]=next;logPush(state,logAP(ev.player,cur,next));break;}case'DRAW_CARDS':{for(let i=0;i<ev.amount;i++){const top=state.decks[ev.player].shift();if(top){state.hands[ev.player].push(top);logPush(state,logDraw(ev.player,top.name));}}break;}case'DISCARD_RANDOM_FROM_HAND':{const hand=state.hands[ev.player];for(let i=0;i<ev.amount&&hand.length>0;i++){const idx=rng.randomInt(hand.length);const[card]=hand.splice(idx,1);state.discard.push(card);logPush(state,logDiscardRandom(ev.player,card.name));}break;}case'DEACTIVATE_RANDOM_HAND':{// Deaktivieren von Handkarten (nicht entfernen)\nconst hand=state.hands[ev.player];const activeCards=hand.filter(c=>!c.deactivated);for(let i=0;i<ev.amount&&activeCards.length>0;i++){const card=rng.pick(activeCards);if(card){card.deactivated=true;logPush(state,logDeactivateRandom(ev.player,card.name));// Entferne aus activeCards für nächste Iteration\nconst idx=activeCards.indexOf(card);if(idx>-1)activeCards.splice(idx,1);}}break;}// Legacy cases - removed\n// SET_DISCOUNT and REFUND_NEXT_INITIATIVE are no longer supported\n// Use ADD_AP instead\ncase'GRANT_SHIELD':{if(!state.shields)state.shields=new Set();const targetUid=ev.targetUid||0;state.shields.add(targetUid);logPush(state,logShield(targetUid));break;}case'DEACTIVATE_CARD':{const card=findCardByUidOnBoard(state,ev.targetUid);if(card){card.deactivated=true;logPush(state,logDeactivateCard(card.name));}break;}case'REACTIVATE_CARD':{const card=findCardByUidOnBoard(state,ev.targetUid);if(card){card.deactivated=false;logPush(state,\"\\uD83D\\uDD04 \".concat(card.name,\" wurde reaktiviert\"));}break;}case'RETURN_TO_HAND':{const card=findCardByUidOnBoard(state,ev.targetUid);if(card){// Remove from board\nfor(const p of[1,2]){for(const lane of['innen','aussen','sofort']){const idx=state.board[p][lane].findIndex(c=>c.uid===ev.targetUid);if(idx!==-1){state.board[p][lane].splice(idx,1);// Add to hand\nstate.hands[ev.player].push(card);logPush(state,\"\\uD83D\\uDD04 \".concat(card.name,\" wurde zur Hand zur\\xFCckgegeben\"));break;}}}}break;}case'CANCEL_CARD':{const card=findCardByUidOnBoard(state,ev.targetUid);if(card){// Remove from board and add to discard\nfor(const p of[1,2]){for(const lane of['innen','aussen','sofort']){const idx=state.board[p][lane].findIndex(c=>c.uid===ev.targetUid);if(idx!==-1){state.board[p][lane].splice(idx,1);state.discard.push(card);logPush(state,\"\\u274C \".concat(card.name,\" wurde annulliert\"));break;}}}}break;}case'REGISTER_TRAP':{registerTrap(state,ev.player,ev.key);logPush(state,\"Trap registered: \".concat(ev.key,\" (P\").concat(ev.player,\")\"));break;}case'BUFF_STRONGEST_GOV':case'ADJUST_INFLUENCE':{// Alias auf BUFF_STRONGEST_GOV\nconst player=ev.player;const amount=ev.amount;const tgt=getStrongestGovernment(state,player);if(tgt){var _state$effectFlags$ot;if(amount>=0){tgt.tempBuffs=(tgt.tempBuffs||0)+amount;}else{tgt.tempDebuffs=(tgt.tempDebuffs||0)+Math.abs(amount);}logPush(state,logBuffStrongest(player,tgt.name,amount));// Opportunist-Spiegelung (falls aktiv beim Gegner)\nif((_state$effectFlags$ot=state.effectFlags[other(player)])!==null&&_state$effectFlags$ot!==void 0&&_state$effectFlags$ot.opportunistActive&&amount>0){const mirror={type:'BUFF_STRONGEST_GOV',player:other(player),amount};events.unshift(mirror);logPush(state,logOpportunist(other(player),amount));}}break;}// ===== New intent event handlers =====\ncase'DEACTIVATE_STRONGEST_ENEMY_GOV':{const opp=ev.player===1?2:1;const uid=strongestGovernmentUid(state,opp);if(uid!==null){events.unshift({type:'DEACTIVATE_CARD',player:opp,targetUid:uid});events.unshift({type:'LOG',msg:'Party Offensive: strongest enemy Government deactivated.'});}else{events.unshift({type:'LOG',msg:'Party Offensive: no enemy Government to deactivate.'});}break;}case'LOCK_OPPONENT_INITIATIVES_EOT':{const opp=ev.player===1?2:1;state.effectFlags[opp].initiativesLocked=true;events.unshift({type:'LOG',msg:'Opposition Blockade: opponent initiatives locked until end of turn.'});break;}case'SET_DOUBLE_PUBLIC_AURA':{state.effectFlags[ev.player].doublePublicAura=true;events.unshift({type:'LOG',msg:'Influencer Campaign: next Public aura will be doubled.'});break;}case'SET_OPPORTUNIST_ACTIVE':{const{player,active}=ev;state.effectFlags[player].opportunistActive=active;if(active){events.unshift({type:'LOG',msg:'Opportunist: AP effects will be mirrored until end of turn.'});}break;}case'GOVERNMENT_CARD_PLAYED':{const f=state.effectFlags[ev.player];// Greta Thunberg AP on first government card\nif(f.gretaFirstGovAp){const cur=state.actionPoints[ev.player];state.actionPoints[ev.player]=cur+1;f.gretaFirstGovAp=false;logPush(state,'Greta Thunberg: +1 AP on first government card played.');}// Check for George Soros AP bonus (when opponent gets authoritarian government)\nconst otherPlayer=ev.player===1?2:1;const otherF=state.effectFlags[otherPlayer];if(otherF.sorosAuthoritarianAp){// Check if the played card is authoritarian\nconst playedCard=state.permanentSlots[ev.player].government;if(playedCard&&isAuthoritarianGovernment(playedCard)){const cur=state.actionPoints[otherPlayer];state.actionPoints[otherPlayer]=cur+1;otherF.sorosAuthoritarianAp=false;logPush(state,\"George Soros: +1 AP (opponent played authoritarian government: \".concat(playedCard.name,\").\"));}}break;}case'INITIATIVE_ACTIVATED':{// Existing logic plus new flag consumptions\nconst f=state.effectFlags[ev.player];// Mark Zuckerberg AP once/turn\nif(f.zuckOnceAp&&!f.zuckSpent){const cur=state.actionPoints[ev.player];state.actionPoints[ev.player]=cur+1;f.zuckSpent=true;logPush(state,'Mark Zuckerberg: +1 AP once per turn.');}// Elon Musk AP once/turn\nif(f.elonOnceAp&&!f.elonSpent){const cur=state.actionPoints[ev.player];state.actionPoints[ev.player]=cur+1;f.elonSpent=true;logPush(state,'Elon Musk: +1 AP once per turn after initiative activation.');}// Bill Gates AP on next initiative\nif(f.gatesNextInitiativeAp){const cur=state.actionPoints[ev.player];state.actionPoints[ev.player]=cur+1;f.gatesNextInitiativeAp=false;logPush(state,'Bill Gates: +1 AP on initiative activation.');}if(f.aiWeiweiOnActivate){const top=state.decks[ev.player].shift();if(top)state.hands[ev.player].push(top);state.actionPoints[ev.player]+=1;f.aiWeiweiOnActivate=false;logPush(state,'Ai Weiwei: drew 1 card and gained +1 AP.');}// Simplified AP system: No initiative-specific bonuses\n// All AP bonuses are now immediate ADD_AP events\n// Double Public Aura – note (consumption happens separately)\nif(f.doublePublicAura){if(!state._effectQueue)state._effectQueue=[];state._effectQueue.push({type:'LOG',msg:'Double Public Aura is armed.'});}break;}// Simplified AP system: No initiative-specific bonuses\n// All AP bonuses are now immediate ADD_AP events\n}}}","map":{"version":3,"names":["getStrongestGovernment","registerTrap","logAP","logDraw","logDiscardRandom","logDeactivateRandom","logBuffStrongest","logShield","logDeactivateCard","logOpportunist","getGlobalRNG","isAuthoritarianGovernment","card","authoritarianNames","includes","name","strongestGovernmentUid","state","p","_state$board$p","govRow","board","aussen","length","alive","filter","g","deactivated","sorted","slice","sort","a","b","influence","tempBuffs","tempDebuffs","uid","other","logPush","msg","log","push","strongestGov","row","c","publicNames","innen","map","hasPublic","findCardByUidOnBoard","lane","arr","hit","find","resolveQueue","events","rng","ev","shift","type","cur","actionPoints","player","next","Math","max","amount","i","top","decks","hands","hand","idx","randomInt","splice","discard","activeCards","pick","indexOf","shields","Set","targetUid","add","concat","findIndex","key","tgt","_state$effectFlags$ot","abs","effectFlags","opportunistActive","mirror","unshift","opp","initiativesLocked","doublePublicAura","active","f","gretaFirstGovAp","otherPlayer","otherF","sorosAuthoritarianAp","playedCard","permanentSlots","government","zuckOnceAp","zuckSpent","elonOnceAp","elonSpent","gatesNextInitiativeAp","aiWeiweiOnActivate","_effectQueue"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/utils/queue.ts"],"sourcesContent":["import { GameState, Player, PoliticianCard, Card } from '../types/game';\r\nimport { EffectEvent } from '../types/effects';\r\nimport { getStrongestGovernment } from './targets';\r\nimport { AP_CAP, MAX_DISCOUNT, MAX_REFUND } from '../config/gameConstants';\r\nimport { registerTrap } from './traps';\r\nimport {\r\n  logAP, logDiscount, logRefund, logDraw, logDiscardRandom,\r\n  logDeactivateRandom, logBuffStrongest, logShield, logDeactivateCard,\r\n  logInitiativeAura, logAiWeiwei, logPlattformBonus, logOpportunist\r\n} from './logs';\r\nimport { getGlobalRNG } from '../services/rng';\r\n\r\n// Helper function to check if a government card is authoritarian\r\nfunction isAuthoritarianGovernment(card: Card): boolean {\r\n  // Authoritarian governments: Putin, Xi Jinping, Erdogan, etc.\r\n  const authoritarianNames = [\r\n    'Vladimir Putin',\r\n    'Xi Jinping', \r\n    'Recep Tayyip Erdogan',\r\n    'Kim Jong-un',\r\n    'Bashar al-Assad',\r\n    'Alexander Lukashenko',\r\n    'Nicolás Maduro',\r\n    'Daniel Ortega'\r\n  ];\r\n  return authoritarianNames.includes(card.name);\r\n}\r\n// Helper to find strongest government uid for new intents\r\nfunction strongestGovernmentUid(state: GameState, p: Player): number | null {\r\n  const govRow = state.board[p]?.aussen as PoliticianCard[];\r\n  if (!govRow || govRow.length === 0) return null;\r\n  const alive = govRow.filter(g => !(g as any).deactivated);\r\n  if (!alive.length) return null;\r\n  const sorted = alive.slice().sort((a,b) => (b.influence + (b.tempBuffs||0) - (b.tempDebuffs||0)) - (a.influence + (a.tempBuffs||0) - (a.tempDebuffs||0)));\r\n  return sorted[0].uid;\r\n}\r\n\r\nfunction other(p: Player): Player { return p === 1 ? 2 : 1; }\r\nfunction logPush(state: GameState, msg: string) { state.log.push(msg); }\r\n\r\nfunction strongestGov(state: GameState, p: Player): PoliticianCard | null {\r\n  const row = state.board[p].aussen as PoliticianCard[];\r\n  if (!row.length) return null;\r\n  const alive = row.filter(c => !c.deactivated);\r\n  if (alive.length === 0) return null;\r\n  return alive.slice().sort((a,b) => (b.influence + (b.tempBuffs||0) - (b.tempDebuffs||0)) - (a.influence + (a.tempBuffs||0) - (a.tempDebuffs||0)))[0];\r\n}\r\n\r\nfunction publicNames(state: GameState, p: Player): string[] {\r\n  return state.board[p].innen.map(c => c.name);\r\n}\r\n\r\nfunction hasPublic(state: GameState, p: Player, name: string): boolean {\r\n  return publicNames(state, p).includes(name);\r\n}\r\n\r\nfunction findCardByUidOnBoard(state: GameState, uid: number): Card | null {\r\n  for (const p of [1,2] as const) {\r\n    for (const lane of ['innen','aussen','sofort'] as const) {\r\n      const arr = state.board[p][lane];\r\n      const hit = arr.find(c => c.uid === uid);\r\n      if (hit) return hit;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function resolveQueue(state: GameState, events: EffectEvent[]) {\r\n  const rng = getGlobalRNG();\r\n\r\n  // Single pass FIFO\r\n  while (events.length) {\r\n    const ev = events.shift()!;\r\n\r\n    switch (ev.type) {\r\n      case 'LOG': {\r\n        logPush(state, ev.msg);\r\n        break;\r\n      }\r\n\r\n      case 'ADD_AP': {\r\n        const cur = state.actionPoints[ev.player];\r\n        const next = Math.max(0, cur + ev.amount);\r\n        state.actionPoints[ev.player] = next;\r\n        logPush(state, logAP(ev.player, cur, next));\r\n        break;\r\n      }\r\n\r\n      case 'DRAW_CARDS': {\r\n        for (let i = 0; i < ev.amount; i++) {\r\n          const top = state.decks[ev.player].shift();\r\n          if (top) {\r\n            state.hands[ev.player].push(top);\r\n            logPush(state, logDraw(ev.player, top.name));\r\n          }\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'DISCARD_RANDOM_FROM_HAND': {\r\n        const hand = state.hands[ev.player];\r\n        for (let i = 0; i < ev.amount && hand.length > 0; i++) {\r\n          const idx = rng.randomInt(hand.length);\r\n          const [card] = hand.splice(idx, 1);\r\n          state.discard.push(card);\r\n          logPush(state, logDiscardRandom(ev.player, card.name));\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'DEACTIVATE_RANDOM_HAND': {\r\n        // Deaktivieren von Handkarten (nicht entfernen)\r\n        const hand = state.hands[ev.player];\r\n        const activeCards = hand.filter(c => !(c as any).deactivated);\r\n        for (let i = 0; i < ev.amount && activeCards.length > 0; i++) {\r\n          const card = rng.pick(activeCards);\r\n          if (card) {\r\n            (card as any).deactivated = true;\r\n            logPush(state, logDeactivateRandom(ev.player, card.name));\r\n            // Entferne aus activeCards für nächste Iteration\r\n            const idx = activeCards.indexOf(card);\r\n            if (idx > -1) activeCards.splice(idx, 1);\r\n          }\r\n        }\r\n        break;\r\n      }\r\n\r\n      // Legacy cases - removed\r\n      // SET_DISCOUNT and REFUND_NEXT_INITIATIVE are no longer supported\r\n      // Use ADD_AP instead\r\n\r\n      case 'GRANT_SHIELD': {\r\n        if (!state.shields) state.shields = new Set();\r\n        const targetUid = ev.targetUid || 0;\r\n        state.shields.add(targetUid);\r\n        logPush(state, logShield(targetUid));\r\n        break;\r\n      }\r\n\r\n      case 'DEACTIVATE_CARD': {\r\n        const card = findCardByUidOnBoard(state, ev.targetUid);\r\n        if (card) {\r\n          (card as any).deactivated = true;\r\n          logPush(state, logDeactivateCard(card.name));\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'REACTIVATE_CARD': {\r\n        const card = findCardByUidOnBoard(state, ev.targetUid);\r\n        if (card) {\r\n          (card as any).deactivated = false;\r\n          logPush(state, `🔄 ${card.name} wurde reaktiviert`);\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'RETURN_TO_HAND': {\r\n        const card = findCardByUidOnBoard(state, ev.targetUid);\r\n        if (card) {\r\n          // Remove from board\r\n          for (const p of [1, 2] as const) {\r\n            for (const lane of ['innen', 'aussen', 'sofort'] as const) {\r\n              const idx = state.board[p][lane].findIndex(c => c.uid === ev.targetUid);\r\n              if (idx !== -1) {\r\n                state.board[p][lane].splice(idx, 1);\r\n                // Add to hand\r\n                state.hands[ev.player].push(card);\r\n                logPush(state, `🔄 ${card.name} wurde zur Hand zurückgegeben`);\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'CANCEL_CARD': {\r\n        const card = findCardByUidOnBoard(state, ev.targetUid);\r\n        if (card) {\r\n          // Remove from board and add to discard\r\n          for (const p of [1, 2] as const) {\r\n            for (const lane of ['innen', 'aussen', 'sofort'] as const) {\r\n              const idx = state.board[p][lane].findIndex(c => c.uid === ev.targetUid);\r\n              if (idx !== -1) {\r\n                state.board[p][lane].splice(idx, 1);\r\n                state.discard.push(card);\r\n                logPush(state, `❌ ${card.name} wurde annulliert`);\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'REGISTER_TRAP': {\r\n        registerTrap(state, ev.player, (ev as any).key);\r\n        logPush(state, `Trap registered: ${(ev as any).key} (P${ev.player})`);\r\n        break;\r\n      }\r\n\r\n      case 'BUFF_STRONGEST_GOV':\r\n      case 'ADJUST_INFLUENCE': { // Alias auf BUFF_STRONGEST_GOV\r\n        const player = ev.player;\r\n        const amount = (ev as any).amount;\r\n        const tgt = getStrongestGovernment(state, player);\r\n        if (tgt) {\r\n          if (amount >= 0) {\r\n            (tgt as PoliticianCard).tempBuffs = ((tgt as PoliticianCard).tempBuffs || 0) + amount;\r\n          } else {\r\n            (tgt as PoliticianCard).tempDebuffs = ((tgt as PoliticianCard).tempDebuffs || 0) + Math.abs(amount);\r\n          }\r\n          logPush(state, logBuffStrongest(player, tgt.name, amount));\r\n\r\n          // Opportunist-Spiegelung (falls aktiv beim Gegner)\r\n          if (state.effectFlags[other(player)]?.opportunistActive && amount > 0) {\r\n            const mirror = { type: 'BUFF_STRONGEST_GOV', player: other(player), amount } as EffectEvent;\r\n            events.unshift(mirror);\r\n            logPush(state, logOpportunist(other(player), amount));\r\n          }\r\n        }\r\n        break;\r\n      }\r\n\r\n      // ===== New intent event handlers =====\r\n\r\n      case 'DEACTIVATE_STRONGEST_ENEMY_GOV': {\r\n        const opp: Player = ev.player === 1 ? 2 : 1;\r\n        const uid = strongestGovernmentUid(state, opp);\r\n        if (uid !== null) {\r\n          events.unshift({ type: 'DEACTIVATE_CARD', player: opp, targetUid: uid });\r\n          events.unshift({ type: 'LOG', msg: 'Party Offensive: strongest enemy Government deactivated.' });\r\n        } else {\r\n          events.unshift({ type: 'LOG', msg: 'Party Offensive: no enemy Government to deactivate.' });\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'LOCK_OPPONENT_INITIATIVES_EOT': {\r\n        const opp: Player = ev.player === 1 ? 2 : 1;\r\n        state.effectFlags[opp].initiativesLocked = true;\r\n        events.unshift({ type: 'LOG', msg: 'Opposition Blockade: opponent initiatives locked until end of turn.' });\r\n        break;\r\n      }\r\n\r\n      case 'SET_DOUBLE_PUBLIC_AURA': {\r\n        state.effectFlags[ev.player].doublePublicAura = true;\r\n        events.unshift({ type: 'LOG', msg: 'Influencer Campaign: next Public aura will be doubled.' });\r\n        break;\r\n      }\r\n\r\n      case 'SET_OPPORTUNIST_ACTIVE': {\r\n        const { player, active } = ev as { type: 'SET_OPPORTUNIST_ACTIVE'; player: Player; active: boolean };\r\n        state.effectFlags[player].opportunistActive = active;\r\n        if (active) {\r\n          events.unshift({ type: 'LOG', msg: 'Opportunist: AP effects will be mirrored until end of turn.' });\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'GOVERNMENT_CARD_PLAYED': {\r\n        const f = state.effectFlags[ev.player];\r\n        // Greta Thunberg AP on first government card\r\n        if (f.gretaFirstGovAp) {\r\n          const cur = state.actionPoints[ev.player];\r\n          state.actionPoints[ev.player] = cur + 1;\r\n          f.gretaFirstGovAp = false;\r\n          logPush(state, 'Greta Thunberg: +1 AP on first government card played.');\r\n        }\r\n        \r\n        // Check for George Soros AP bonus (when opponent gets authoritarian government)\r\n        const otherPlayer = ev.player === 1 ? 2 : 1;\r\n        const otherF = state.effectFlags[otherPlayer];\r\n        if (otherF.sorosAuthoritarianAp) {\r\n          // Check if the played card is authoritarian\r\n          const playedCard = state.permanentSlots[ev.player].government;\r\n          if (playedCard && isAuthoritarianGovernment(playedCard)) {\r\n            const cur = state.actionPoints[otherPlayer];\r\n            state.actionPoints[otherPlayer] = cur + 1;\r\n            otherF.sorosAuthoritarianAp = false;\r\n            logPush(state, `George Soros: +1 AP (opponent played authoritarian government: ${playedCard.name}).`);\r\n          }\r\n        }\r\n        break;\r\n      }\r\n\r\n      case 'INITIATIVE_ACTIVATED': {\r\n        // Existing logic plus new flag consumptions\r\n        const f = state.effectFlags[ev.player];\r\n        // Mark Zuckerberg AP once/turn\r\n        if (f.zuckOnceAp && !f.zuckSpent) {\r\n          const cur = state.actionPoints[ev.player];\r\n          state.actionPoints[ev.player] = cur + 1;\r\n          f.zuckSpent = true;\r\n          logPush(state, 'Mark Zuckerberg: +1 AP once per turn.');\r\n        }\r\n        // Elon Musk AP once/turn\r\n        if (f.elonOnceAp && !f.elonSpent) {\r\n          const cur = state.actionPoints[ev.player];\r\n          state.actionPoints[ev.player] = cur + 1;\r\n          f.elonSpent = true;\r\n          logPush(state, 'Elon Musk: +1 AP once per turn after initiative activation.');\r\n        }\r\n        // Bill Gates AP on next initiative\r\n        if (f.gatesNextInitiativeAp) {\r\n          const cur = state.actionPoints[ev.player];\r\n          state.actionPoints[ev.player] = cur + 1;\r\n          f.gatesNextInitiativeAp = false;\r\n          logPush(state, 'Bill Gates: +1 AP on initiative activation.');\r\n        }\r\n        if (f.aiWeiweiOnActivate) {\r\n          const top = state.decks[ev.player].shift();\r\n          if (top) state.hands[ev.player].push(top);\r\n          state.actionPoints[ev.player] += 1;\r\n          f.aiWeiweiOnActivate = false;\r\n          logPush(state, 'Ai Weiwei: drew 1 card and gained +1 AP.');\r\n        }\r\n        // Simplified AP system: No initiative-specific bonuses\r\n        // All AP bonuses are now immediate ADD_AP events\r\n        // Double Public Aura – note (consumption happens separately)\r\n        if (f.doublePublicAura) {\r\n          if (!state._effectQueue) state._effectQueue = [];\r\n          state._effectQueue.push({ type: 'LOG', msg: 'Double Public Aura is armed.' });\r\n        }\r\n        break;\r\n      }\r\n\r\n      // Simplified AP system: No initiative-specific bonuses\r\n      // All AP bonuses are now immediate ADD_AP events\r\n\r\n\r\n    }\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}