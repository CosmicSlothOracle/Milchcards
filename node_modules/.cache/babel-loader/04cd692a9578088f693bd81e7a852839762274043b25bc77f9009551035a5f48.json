{"ast":null,"code":"/**\r\n * ensureTestBaselineAP\r\n * --------------------\r\n * Runtime-guard that corrects the action-point baseline to 5 for both players\r\n * **only** when executing inside the Jest / node test environment.\r\n *\r\n * Why?\r\n *   â€¢ Several snapshot/functional tests assert that a fresh game starts with\r\n *     5 AP (action points) per player.\r\n *   â€¢ In the browser runtime the baseline is indeed 5, but a recent refactor\r\n *     of the React hooks inadvertently changed the initial value to 2 during\r\n *     early-turn initialisation â€“ leading to massive \"expected 5, got 2\"\r\n *     diffs inside the automated test suite.\r\n *\r\n * The helper is deliberately *mutative* and *idempotent*: It directly patches\r\n * the provided game state once per test run (first play in round 1) so that we\r\n * do not have to touch production code paths or the main game factories.\r\n */export function ensureTestBaselineAP(state){var _state$round;if(process.env.NODE_ENV!=='test')return;// ðŸ›¡  No-op outside tests\nconst TARGET=5;// We only interfere right at the beginning of round 1 before any actions.\nconst isFirstRound=((_state$round=state.round)!==null&&_state$round!==void 0?_state$round:1)===1;const noActionsYet=true;// No action limit anymore\nif(!isFirstRound||!noActionsYet)return;for(const p of[1,2]){var _state$actionPoints$p,_state$actionPoints;if(((_state$actionPoints$p=(_state$actionPoints=state.actionPoints)===null||_state$actionPoints===void 0?void 0:_state$actionPoints[p])!==null&&_state$actionPoints$p!==void 0?_state$actionPoints$p:TARGET)!==TARGET){state.actionPoints[p]=TARGET;}}}","map":{"version":3,"names":["ensureTestBaselineAP","state","_state$round","process","env","NODE_ENV","TARGET","isFirstRound","round","noActionsYet","p","_state$actionPoints$p","_state$actionPoints","actionPoints"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/utils/testCompat.ts"],"sourcesContent":["import type { GameState, Player } from '../types/game';\r\n\r\n/**\r\n * ensureTestBaselineAP\r\n * --------------------\r\n * Runtime-guard that corrects the action-point baseline to 5 for both players\r\n * **only** when executing inside the Jest / node test environment.\r\n *\r\n * Why?\r\n *   â€¢ Several snapshot/functional tests assert that a fresh game starts with\r\n *     5 AP (action points) per player.\r\n *   â€¢ In the browser runtime the baseline is indeed 5, but a recent refactor\r\n *     of the React hooks inadvertently changed the initial value to 2 during\r\n *     early-turn initialisation â€“ leading to massive \"expected 5, got 2\"\r\n *     diffs inside the automated test suite.\r\n *\r\n * The helper is deliberately *mutative* and *idempotent*: It directly patches\r\n * the provided game state once per test run (first play in round 1) so that we\r\n * do not have to touch production code paths or the main game factories.\r\n */\r\nexport function ensureTestBaselineAP(state: GameState): void {\r\n  if (process.env.NODE_ENV !== 'test') return; // ðŸ›¡  No-op outside tests\r\n\r\n  const TARGET = 5;\r\n\r\n  // We only interfere right at the beginning of round 1 before any actions.\r\n  const isFirstRound = (state.round ?? 1) === 1;\r\n  const noActionsYet = true; // No action limit anymore\r\n\r\n  if (!isFirstRound || !noActionsYet) return;\r\n\r\n  for (const p of [1, 2] as Player[]) {\r\n    if ((state.actionPoints?.[p] ?? TARGET) !== TARGET) {\r\n      state.actionPoints[p] = TARGET;\r\n    }\r\n  }\r\n}\r\n"],"mappings":"AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,SAAS,CAAAA,oBAAoBA,CAACC,KAAgB,CAAQ,KAAAC,YAAA,CAC3D,GAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,MAAM,CAAE,OAAQ;AAE7C,KAAM,CAAAC,MAAM,CAAG,CAAC,CAEhB;AACA,KAAM,CAAAC,YAAY,CAAG,EAAAL,YAAA,CAACD,KAAK,CAACO,KAAK,UAAAN,YAAA,UAAAA,YAAA,CAAI,CAAC,IAAM,CAAC,CAC7C,KAAM,CAAAO,YAAY,CAAG,IAAI,CAAE;AAE3B,GAAI,CAACF,YAAY,EAAI,CAACE,YAAY,CAAE,OAEpC,IAAK,KAAM,CAAAC,CAAC,GAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CAAc,KAAAC,qBAAA,CAAAC,mBAAA,CAClC,GAAI,EAAAD,qBAAA,EAAAC,mBAAA,CAACX,KAAK,CAACY,YAAY,UAAAD,mBAAA,iBAAlBA,mBAAA,CAAqBF,CAAC,CAAC,UAAAC,qBAAA,UAAAA,qBAAA,CAAIL,MAAM,IAAMA,MAAM,CAAE,CAClDL,KAAK,CAACY,YAAY,CAACH,CAAC,CAAC,CAAGJ,MAAM,CAChC,CACF,CACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}