{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{Specials}from'../data/gameData';import{drawCardImage,sortHandCards}from'../utils/gameUtils';import{getCardDetails,convertHPToUSD}from'../data/cardDetails';import{withIcons}from'../ui/withIcons';import{makeUid}from'../utils/id';import{getNetApCost}from'../utils/ap';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const HandCardModal=_ref=>{let{gameState,selectedHandIndex,isVisible,onClose,onPlayCard}=_ref;const[currentIndex,setCurrentIndex]=useState(0);const[waitingForReplacement,setWaitingForReplacement]=useState(null);// üîß DEV MODE: Unterst√ºtzung f√ºr beide Player\nconst currentPlayer=gameState.current;const sortedHand=sortHandCards(gameState.hands[currentPlayer]);const currentCard=sortedHand[currentIndex];// Safety: Falls die Karte (aus Altbest√§nden) keine uid hat, vergib tempor√§r eine (nur UI-seitig)\nif(currentCard&&!currentCard.uid){currentCard.uid=makeUid('card_ui');}// Update current index when selectedHandIndex changes\nuseEffect(()=>{if(selectedHandIndex!==null&&isVisible){const selectedCard=gameState.hands[currentPlayer][selectedHandIndex];const sortedIndex=sortedHand.findIndex(card=>card.uid===(selectedCard===null||selectedCard===void 0?void 0:selectedCard.uid));if(sortedIndex!==-1){setCurrentIndex(sortedIndex);}}},[selectedHandIndex,isVisible,currentPlayer]);// Removed gameState.hands and sortedHand to prevent infinite loop\n// Get target slot for card - commented out as unused\n// const getTargetSlot = useCallback((card: Card) => {\n//   if (card.kind === 'pol') {\n//     const polCard = card as PoliticianCard;\n//     const isGovernment = ['Staatsoberhaupt', 'Regierungschef', 'Diplomat', 'Minister', 'Abgeordneter', 'Berater'].includes(polCard.tag);\n//     return isGovernment ? 'aussen' : 'innen';\n//   } else {\n//     const specCard = card as SpecialCard;\n//     if (specCard.type === '√ñffentlichkeitskarte') {\n//       return 'innen'; // Public cards go to public row\n//     }\n//     if (specCard.type === 'Dauerhaft-Initiative') {\n//       // Would need to determine government vs public based on card effect\n//       return 'permanent_government'; // or 'permanent_public'\n//     }\n//     if (specCard.type === 'Sofort-Initiative') {\n//       return 'instant';\n//     }\n//     if (specCard.type === 'Intervention') {\n//       return 'intervention';\n//     }\n//   }\n//   return null;\n// }, []);\n// Check if target slot is full\nconst isSlotFull=useCallback(slot=>{switch(slot){case'aussen':return gameState.board[currentPlayer].aussen.length>=5;case'innen':return gameState.board[currentPlayer].innen.length>=5;case'permanent_government':return gameState.permanentSlots[currentPlayer].government!==null;case'permanent_public':return gameState.permanentSlots[currentPlayer].public!==null;case'instant':return gameState.board[currentPlayer].sofort.length>0;case'intervention':return gameState.traps[currentPlayer].length>=6;default:return false;}},[gameState,currentPlayer]);// Helper functions for safe index mapping\nconst findOriginalIndexByUid=useCallback((hand,uid)=>{if(!Array.isArray(hand)||!uid)return-1;return hand.findIndex(c=>c.uid===uid);},[]);const targetSlotFromCard=useCallback(c=>{const any=c;// Heuristik wie in useGameActions: Diplomaten/Regierungschefs au√üen\nif(c.kind==='pol'&&['Staatsoberhaupt','Regierungschef','Diplomat'].includes(any.tag))return'aussen';if(c.kind==='pol')return'aussen';if(c.kind==='spec'&&any.type==='√ñffentlichkeitskarte')return'innen';return'innen';},[]);// Handle automatic card placement\nconst handleAutoPlay=useCallback(()=>{const card=sortedHand[currentIndex];if(!card){return;}const hand=gameState.hands[currentPlayer];let originalIndex=findOriginalIndexByUid(hand,card.uid);if(originalIndex<0){// Fallbacks: Name-Match ‚Üí erster Treffer ‚Üí sichtbarer Index\nconst byName=hand.findIndex(h=>h.name===card.name);originalIndex=byName>=0?byName:currentIndex;console.warn('[Modal] UID not found. Fallback index used:',originalIndex);}const targetSlot=targetSlotFromCard(card);if(isSlotFull(targetSlot)){console.log('‚ùå DEBUG: Slot is full');setWaitingForReplacement(targetSlot);return;}console.log('üîß DEBUG: Calling onPlayCard with:',originalIndex,targetSlot);onPlayCard(originalIndex,targetSlot);onClose();},[sortedHand,currentIndex,gameState.hands,currentPlayer,findOriginalIndexByUid,targetSlotFromCard,isSlotFull,onPlayCard,onClose]);// Keyboard navigation\nuseEffect(()=>{if(!isVisible)return;const handleKeyDown=event=>{switch(event.key){case'ArrowLeft':event.preventDefault();setCurrentIndex(prev=>Math.max(0,prev-1));break;case'ArrowRight':event.preventDefault();setCurrentIndex(prev=>Math.min(sortedHand.length-1,prev+1));break;case'Escape':event.preventDefault();onClose();break;case'Enter':event.preventDefault();handleAutoPlay();break;}};window.addEventListener('keydown',handleKeyDown);return()=>window.removeEventListener('keydown',handleKeyDown);},[isVisible,sortedHand.length,onClose,setCurrentIndex,handleAutoPlay]);// Handle replacement selection (TODO: Implement replacement logic)\n// const handleReplacementClick = useCallback((targetCard: Card) => {\n//   if (!waitingForReplacement || !currentCard) return;\n//   const originalIndex = gameState.hands[currentPlayer].findIndex(c => c.uid === currentCard.uid);\n//   onPlayCard(originalIndex, waitingForReplacement);\n//   setWaitingForReplacement(null);\n//   onClose();\n// }, [waitingForReplacement, currentCard, gameState.hands, onPlayCard, onClose]);\nif(!isVisible||!currentCard){return null;}const cardDetails=getCardDetails(currentCard.name);// const hand = gameState.hands[currentPlayer]; // unused\n// const sel = selectedHandIndex != null ? hand[selectedHandIndex] : null; // unused\nconst laneHint=currentCard.kind==='pol'?currentCard.tag==='Staatsoberhaupt'||currentCard.tag==='Regierungschef'||currentCard.tag==='Diplomat'?'aussen':'innen':'innen';// Modal/Play-Gate: \"nur Zero-AP m√∂glich\" korrekt behandeln\nconst{net}=getNetApCost(gameState,currentPlayer,currentCard,laneHint);const wouldZero=net<=0;const actionsUsed=gameState.actionsUsed[currentPlayer];const canPlay=actionsUsed<2||wouldZero;const onlyZeroApPossible=actionsUsed>=2&&wouldZero;return/*#__PURE__*/_jsxs(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0,0,0,0.8)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:1500},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'#0d1621',border:'3px solid #ffffff',borderRadius:'16px',padding:'24px',display:'flex',gap:'24px',width:'calc(35vw)',// 50% smaller than deckbuilder\nheight:'calc(45vh)',overflow:'hidden',position:'relative'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:'0 0 512px',// 50% of 1024px\nheight:'512px',background:'#0b1118',border:'2px solid #ffffff',clipPath:'polygon(50px 0, calc(100% - 50px) 0, 100% 50px, 100% 100%, 0 100%, 0 50px)',overflow:'hidden',position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentIndex(prev=>Math.max(0,prev-1)),disabled:currentIndex===0,style:{position:'absolute',left:'16px',top:'50%',transform:'translateY(-50%)',background:'rgba(13, 22, 33, 0.9)',border:'2px solid #1f3042',borderRadius:'50%',width:'48px',height:'48px',display:'flex',alignItems:'center',justifyContent:'center',cursor:currentIndex>0?'pointer':'not-allowed',color:'#eaf3ff',fontSize:'20px',fontWeight:'bold',zIndex:10,opacity:currentIndex>0?1:0.5},children:\"\\u2039\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentIndex(prev=>Math.min(sortedHand.length-1,prev+1)),disabled:currentIndex===sortedHand.length-1,style:{position:'absolute',right:'16px',top:'50%',transform:'translateY(-50%)',background:'rgba(13, 22, 33, 0.9)',border:'2px solid #1f3042',borderRadius:'50%',width:'48px',height:'48px',display:'flex',alignItems:'center',justifyContent:'center',cursor:currentIndex<sortedHand.length-1?'pointer':'not-allowed',color:'#eaf3ff',fontSize:'20px',fontWeight:'bold',zIndex:10,opacity:currentIndex<sortedHand.length-1?1:0.5},children:\"\\u203A\"}),/*#__PURE__*/_jsx(\"canvas\",{width:512,height:512,style:{display:'block',width:'512px',height:'512px',clipPath:'polygon(50px 0, calc(100% - 50px) 0, 100% 50px, 100% 100%, 0 100%, 0 50px)'},ref:canvas=>{if(canvas&&currentCard){const ctx=canvas.getContext('2d');if(ctx){drawCardImage(ctx,currentCard,0,0,512,'modal');}}}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:'1',minWidth:'200px',display:'flex',flexDirection:'column',gap:'12px',position:'relative'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'flex-start'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:'0 0 4px 0',fontSize:'20px',fontWeight:700,color:'#eaf3ff',lineHeight:'1.2'},children:currentCard.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#6b7280',fontWeight:500,display:'flex',gap:'8px',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Karte \",currentIndex+1,\" von \",sortedHand.length]}),/*#__PURE__*/_jsxs(\"span\",{style:{background:currentPlayer===1?'#4ade80':'#ef4444',color:'white',padding:'2px 6px',borderRadius:'4px',fontSize:'10px',fontWeight:600},children:[\"P\",currentPlayer]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'none',border:'none',color:'#8faecc',fontSize:'20px',cursor:'pointer',padding:'4px',borderRadius:'4px'},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#111827',border:'1px solid #ffffff',borderRadius:'8px',padding:'12px',fontSize:'12px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:'#9ca3af',marginBottom:'4px'},children:\"Typ & Kosten\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#e5e7eb'},children:currentCard.kind==='pol'?\"Regierung/\\xD6ffentlichkeit \\u2022 \".concat(convertHPToUSD(currentCard.BP||0)):\"\".concat(currentCard.type,\" \\u2022 \").concat(convertHPToUSD(currentCard.bp))}),(cardDetails===null||cardDetails===void 0?void 0:cardDetails.subcategories)&&cardDetails.subcategories.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:'#9ca3af',marginBottom:'4px'},children:\"Schl\\xFCsselw\\xF6rter\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#e5e7eb',fontSize:'11px'},children:withIcons(cardDetails.subcategories.join(', '),12)})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#111827',border:'1px solid #ffffff',borderRadius:'8px',padding:'12px',fontSize:'12px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:'#9ca3af',marginBottom:'8px',fontWeight:'600'},children:\"AP-Kosten\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',color:'#e5e7eb',marginBottom:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Basis\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"1 AP \\u2192 \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\u22121\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',color:'#e5e7eb',marginBottom:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Refunds\"}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"+\",1-net]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginTop:'8px',padding:'6px 8px',background:net===0?'rgba(16, 185, 129, 0.1)':'rgba(245, 158, 11, 0.1)',border:\"1px solid \".concat(net===0?'#10b981':'#f59e0b'),borderRadius:'4px',fontWeight:'600'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:net===0?'#10b981':'#f59e0b'},children:\"Netto\"}),/*#__PURE__*/_jsxs(\"span\",{style:{color:net===0?'#10b981':'#f59e0b'},children:[net,\" AP \",net===0?'¬∑ verbraucht keine Aktion':'']})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#111827',border:'1px solid #ffffff',borderRadius:'8px',padding:'12px',flex:1},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 8px 0',fontSize:'14px',fontWeight:600,color:'#e5e7eb'},children:\"Spieleffekt\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:0,color:'#d1d5db',lineHeight:'1.4',fontSize:'12px'},children:cardDetails!==null&&cardDetails!==void 0&&cardDetails.gameEffect?withIcons(cardDetails.gameEffect,14):currentCard.kind==='spec'?(()=>{const specCard=currentCard;const baseSpecial=Specials.find(s=>s.id===specCard.baseId);return(baseSpecial===null||baseSpecial===void 0?void 0:baseSpecial.effect)||'Keine Beschreibung verf√ºgbar';})():'Politiker-F√§higkeiten basierend auf Tag'})]}),/*#__PURE__*/_jsx(\"button\",{disabled:!canPlay,onClick:()=>{console.log('üîß DEBUG: Button clicked!');handleAutoPlay();},style:{background:waitingForReplacement?'linear-gradient(45deg, #f59e0b, #f97316)':canPlay?'linear-gradient(45deg, #10b981, #059669)':'linear-gradient(45deg, #6b7280, #4b5563)',border:'none',borderRadius:'8px',padding:'12px 16px',color:'white',fontSize:'14px',fontWeight:'bold',cursor:canPlay?'pointer':'not-allowed',animation:canPlay?'pulse 2s infinite':'none',boxShadow:canPlay?'0 4px 16px rgba(16, 185, 129, 0.4)':'none'},children:waitingForReplacement?'Karte zum Tauschen w√§hlen':canPlay?\"Spielen (Netto \".concat(net,\" AP)\"):'Nicht spielbar'}),!canPlay&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(239, 68, 68, 0.1)',border:'1px solid #ef4444',borderRadius:'6px',padding:'8px 12px',color:'#f87171',fontSize:'12px',textAlign:'center'},children:[\"\\u26A0\\uFE0F \",(_gameState$actionPoin=>{const currentAP=(_gameState$actionPoin=gameState.actionPoints[currentPlayer])!==null&&_gameState$actionPoin!==void 0?_gameState$actionPoin:0;if(currentAP<net){return\"Zu wenig AP: ben\\xF6tigt \".concat(net,\", vorhanden \").concat(currentAP);}if(actionsUsed>=2&&net>0){return'Nur Netto-0-Z√ºge erlaubt (Aktionslimit erreicht)';}return'Karte kann nicht gespielt werden';})()]}),onlyZeroApPossible&&/*#__PURE__*/_jsx(\"div\",{style:{background:'rgba(59, 130, 246, 0.1)',border:'1px solid #3b82f6',borderRadius:'6px',padding:'8px 12px',color:'#60a5fa',fontSize:'12px',textAlign:'center'},children:\"0-AP-Zug verf\\xFCgbar \\u2013 spiele unbegrenzt viele Karten mit Netto 0 AP!\"}),waitingForReplacement&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'11px',color:'#f59e0b',textAlign:'center',marginTop:'4px'},children:\"Slot ist voll - klicke auf eine Karte zum Ersetzen\"})]})]}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n        @keyframes pulse {\\n          0%, 100% { transform: scale(1); }\\n          50% { transform: scale(1.05); }\\n        }\\n      \"})]});};","map":{"version":3,"names":["React","useState","useEffect","useCallback","Specials","drawCardImage","sortHandCards","getCardDetails","convertHPToUSD","withIcons","makeUid","getNetApCost","jsx","_jsx","jsxs","_jsxs","HandCardModal","_ref","gameState","selectedHandIndex","isVisible","onClose","onPlayCard","currentIndex","setCurrentIndex","waitingForReplacement","setWaitingForReplacement","currentPlayer","current","sortedHand","hands","currentCard","uid","selectedCard","sortedIndex","findIndex","card","isSlotFull","slot","board","aussen","length","innen","permanentSlots","government","public","sofort","traps","findOriginalIndexByUid","hand","Array","isArray","c","targetSlotFromCard","any","kind","includes","tag","type","handleAutoPlay","originalIndex","byName","h","name","console","warn","targetSlot","log","handleKeyDown","event","key","preventDefault","prev","Math","max","min","window","addEventListener","removeEventListener","cardDetails","laneHint","net","wouldZero","actionsUsed","canPlay","onlyZeroApPossible","style","position","top","left","right","bottom","background","display","alignItems","justifyContent","zIndex","children","border","borderRadius","padding","gap","width","height","overflow","flex","clipPath","onClick","disabled","transform","cursor","color","fontSize","fontWeight","opacity","ref","canvas","ctx","getContext","minWidth","flexDirection","margin","lineHeight","marginBottom","concat","BP","bp","subcategories","marginTop","join","gameEffect","specCard","baseSpecial","find","s","id","baseId","effect","animation","boxShadow","textAlign","_gameState$actionPoin","currentAP","actionPoints"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/components/HandCardModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { GameState, Card, PoliticianCard, SpecialCard } from '../types/game';\nimport { Specials } from '../data/gameData';\nimport { drawCardImage, sortHandCards } from '../utils/gameUtils';\nimport { getCardDetails, convertHPToUSD } from '../data/cardDetails';\nimport { withIcons } from '../ui/withIcons';\nimport { makeUid } from '../utils/id';\nimport { wouldBeNetZero, getNetApCost } from '../utils/ap';\n\ninterface HandCardModalProps {\n  gameState: GameState;\n  selectedHandIndex: number | null;\n  isVisible: boolean;\n  onClose: () => void;\n  onPlayCard: (index: number, targetSlot?: string) => void;\n}\n\nexport const HandCardModal: React.FC<HandCardModalProps> = ({\n  gameState,\n  selectedHandIndex,\n  isVisible,\n  onClose,\n  onPlayCard\n}) => {\n  const [currentIndex, setCurrentIndex] = useState<number>(0);\n  const [waitingForReplacement, setWaitingForReplacement] = useState<string | null>(null);\n\n  // üîß DEV MODE: Unterst√ºtzung f√ºr beide Player\n  const currentPlayer = gameState.current;\n  const sortedHand = sortHandCards(gameState.hands[currentPlayer]);\n  const currentCard = sortedHand[currentIndex];\n\n  // Safety: Falls die Karte (aus Altbest√§nden) keine uid hat, vergib tempor√§r eine (nur UI-seitig)\n  if (currentCard && !(currentCard as any).uid) {\n    (currentCard as any).uid = makeUid('card_ui');\n  }\n\n  // Update current index when selectedHandIndex changes\n  useEffect(() => {\n    if (selectedHandIndex !== null && isVisible) {\n      const selectedCard = gameState.hands[currentPlayer][selectedHandIndex];\n      const sortedIndex = sortedHand.findIndex((card: Card) => card.uid === selectedCard?.uid);\n      if (sortedIndex !== -1) {\n        setCurrentIndex(sortedIndex);\n      }\n    }\n  }, [selectedHandIndex, isVisible, currentPlayer]); // Removed gameState.hands and sortedHand to prevent infinite loop\n\n\n\n  // Get target slot for card - commented out as unused\n  // const getTargetSlot = useCallback((card: Card) => {\n  //   if (card.kind === 'pol') {\n  //     const polCard = card as PoliticianCard;\n  //     const isGovernment = ['Staatsoberhaupt', 'Regierungschef', 'Diplomat', 'Minister', 'Abgeordneter', 'Berater'].includes(polCard.tag);\n  //     return isGovernment ? 'aussen' : 'innen';\n  //   } else {\n  //     const specCard = card as SpecialCard;\n  //     if (specCard.type === '√ñffentlichkeitskarte') {\n  //       return 'innen'; // Public cards go to public row\n  //     }\n  //     if (specCard.type === 'Dauerhaft-Initiative') {\n  //       // Would need to determine government vs public based on card effect\n  //       return 'permanent_government'; // or 'permanent_public'\n  //     }\n  //     if (specCard.type === 'Sofort-Initiative') {\n  //       return 'instant';\n  //     }\n  //     if (specCard.type === 'Intervention') {\n  //       return 'intervention';\n  //     }\n  //   }\n  //   return null;\n  // }, []);\n\n  // Check if target slot is full\n  const isSlotFull = useCallback((slot: string) => {\n    switch (slot) {\n      case 'aussen':\n        return gameState.board[currentPlayer].aussen.length >= 5;\n      case 'innen':\n        return gameState.board[currentPlayer].innen.length >= 5;\n      case 'permanent_government':\n        return gameState.permanentSlots[currentPlayer].government !== null;\n      case 'permanent_public':\n        return gameState.permanentSlots[currentPlayer].public !== null;\n      case 'instant':\n        return gameState.board[currentPlayer].sofort.length > 0;\n      case 'intervention':\n        return gameState.traps[currentPlayer].length >= 6;\n      default:\n        return false;\n    }\n  }, [gameState, currentPlayer]);\n\n  // Helper functions for safe index mapping\n  const findOriginalIndexByUid = useCallback((hand: Card[], uid?: string): number => {\n    if (!Array.isArray(hand) || !uid) return -1;\n    return hand.findIndex(c => (c as any).uid === uid);\n  }, []);\n\n  const targetSlotFromCard = useCallback((c: Card): 'innen' | 'aussen' => {\n    const any = c as any;\n    // Heuristik wie in useGameActions: Diplomaten/Regierungschefs au√üen\n    if (c.kind === 'pol' && ['Staatsoberhaupt','Regierungschef','Diplomat'].includes(any.tag)) return 'aussen';\n    if (c.kind === 'pol') return 'aussen';\n    if (c.kind === 'spec' && any.type === '√ñffentlichkeitskarte') return 'innen';\n    return 'innen';\n  }, []);\n\n  // Handle automatic card placement\n  const handleAutoPlay = useCallback(() => {\n    const card = sortedHand[currentIndex];\n    if (!card) {\n      return;\n    }\n\n    const hand = gameState.hands[currentPlayer];\n    let originalIndex = findOriginalIndexByUid(hand, (card as any).uid);\n    if (originalIndex < 0) {\n      // Fallbacks: Name-Match ‚Üí erster Treffer ‚Üí sichtbarer Index\n      const byName = hand.findIndex(h => h.name === card.name);\n      originalIndex = byName >= 0 ? byName : currentIndex;\n      console.warn('[Modal] UID not found. Fallback index used:', originalIndex);\n    }\n\n    const targetSlot = targetSlotFromCard(card);\n\n\n\n    if (isSlotFull(targetSlot)) {\n      console.log('‚ùå DEBUG: Slot is full');\n      setWaitingForReplacement(targetSlot);\n      return;\n    }\n\n    console.log('üîß DEBUG: Calling onPlayCard with:', originalIndex, targetSlot);\n    onPlayCard(originalIndex, targetSlot);\n    onClose();\n  }, [sortedHand, currentIndex, gameState.hands, currentPlayer, findOriginalIndexByUid, targetSlotFromCard, isSlotFull, onPlayCard, onClose]);\n\n  // Keyboard navigation\n  useEffect(() => {\n    if (!isVisible) return;\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      switch (event.key) {\n        case 'ArrowLeft':\n          event.preventDefault();\n          setCurrentIndex(prev => Math.max(0, prev - 1));\n          break;\n        case 'ArrowRight':\n          event.preventDefault();\n          setCurrentIndex(prev => Math.min(sortedHand.length - 1, prev + 1));\n          break;\n        case 'Escape':\n          event.preventDefault();\n          onClose();\n          break;\n        case 'Enter':\n          event.preventDefault();\n          handleAutoPlay();\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isVisible, sortedHand.length, onClose, setCurrentIndex, handleAutoPlay]);\n\n  // Handle replacement selection (TODO: Implement replacement logic)\n  // const handleReplacementClick = useCallback((targetCard: Card) => {\n  //   if (!waitingForReplacement || !currentCard) return;\n  //   const originalIndex = gameState.hands[currentPlayer].findIndex(c => c.uid === currentCard.uid);\n  //   onPlayCard(originalIndex, waitingForReplacement);\n  //   setWaitingForReplacement(null);\n  //   onClose();\n  // }, [waitingForReplacement, currentCard, gameState.hands, onPlayCard, onClose]);\n\n  if (!isVisible || !currentCard) {\n    return null;\n  }\n\n  const cardDetails = getCardDetails(currentCard.name);\n  // const hand = gameState.hands[currentPlayer]; // unused\n  // const sel = selectedHandIndex != null ? hand[selectedHandIndex] : null; // unused\n  const laneHint = (currentCard.kind === 'pol')\n    ? ((currentCard as any).tag === 'Staatsoberhaupt' || (currentCard as any).tag === 'Regierungschef' || (currentCard as any).tag === 'Diplomat' ? 'aussen' : 'innen')\n    : 'innen';\n\n  // Modal/Play-Gate: \"nur Zero-AP m√∂glich\" korrekt behandeln\n  const { net } = getNetApCost(gameState, currentPlayer, currentCard, laneHint);\n  const wouldZero = net <= 0;\n  const actionsUsed = gameState.actionsUsed[currentPlayer];\n  const canPlay = actionsUsed < 2 || wouldZero;\n  const onlyZeroApPossible = actionsUsed >= 2 && wouldZero;\n\n\n\n  return (\n    <div style={{\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      background: 'rgba(0,0,0,0.8)',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      zIndex: 1500,\n    }}>\n      <div style={{\n        background: '#0d1621',\n        border: '3px solid #ffffff',\n        borderRadius: '16px',\n        padding: '24px',\n        display: 'flex',\n        gap: '24px',\n        width: 'calc(35vw)', // 50% smaller than deckbuilder\n        height: 'calc(45vh)',\n        overflow: 'hidden',\n        position: 'relative',\n      }}>\n        {/* Card Image */}\n        <div style={{\n          flex: '0 0 512px', // 50% of 1024px\n          height: '512px',\n          background: '#0b1118',\n          border: '2px solid #ffffff',\n          clipPath: 'polygon(50px 0, calc(100% - 50px) 0, 100% 50px, 100% 100%, 0 100%, 0 50px)',\n          overflow: 'hidden',\n          position: 'relative',\n        }}>\n          {/* Navigation Arrows */}\n          <button\n            onClick={() => setCurrentIndex(prev => Math.max(0, prev - 1))}\n            disabled={currentIndex === 0}\n            style={{\n              position: 'absolute',\n              left: '16px',\n              top: '50%',\n              transform: 'translateY(-50%)',\n              background: 'rgba(13, 22, 33, 0.9)',\n              border: '2px solid #1f3042',\n              borderRadius: '50%',\n              width: '48px',\n              height: '48px',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              cursor: currentIndex > 0 ? 'pointer' : 'not-allowed',\n              color: '#eaf3ff',\n              fontSize: '20px',\n              fontWeight: 'bold',\n              zIndex: 10,\n              opacity: currentIndex > 0 ? 1 : 0.5,\n            }}\n          >\n            ‚Äπ\n          </button>\n\n          <button\n            onClick={() => setCurrentIndex(prev => Math.min(sortedHand.length - 1, prev + 1))}\n            disabled={currentIndex === sortedHand.length - 1}\n            style={{\n              position: 'absolute',\n              right: '16px',\n              top: '50%',\n              transform: 'translateY(-50%)',\n              background: 'rgba(13, 22, 33, 0.9)',\n              border: '2px solid #1f3042',\n              borderRadius: '50%',\n              width: '48px',\n              height: '48px',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              cursor: currentIndex < sortedHand.length - 1 ? 'pointer' : 'not-allowed',\n              color: '#eaf3ff',\n              fontSize: '20px',\n              fontWeight: 'bold',\n              zIndex: 10,\n              opacity: currentIndex < sortedHand.length - 1 ? 1 : 0.5,\n            }}\n          >\n            ‚Ä∫\n          </button>\n\n          <canvas\n            width={512}\n            height={512}\n            style={{\n              display: 'block',\n              width: '512px',\n              height: '512px',\n              clipPath: 'polygon(50px 0, calc(100% - 50px) 0, 100% 50px, 100% 100%, 0 100%, 0 50px)',\n            }}\n            ref={(canvas) => {\n              if (canvas && currentCard) {\n                const ctx = canvas.getContext('2d');\n                if (ctx) {\n                  drawCardImage(ctx, currentCard, 0, 0, 512, 'modal');\n                }\n              }\n            }}\n          />\n        </div>\n\n        {/* Card Information */}\n        <div style={{\n          flex: '1',\n          minWidth: '200px',\n          display: 'flex',\n          flexDirection: 'column',\n          gap: '12px',\n          position: 'relative',\n        }}>\n          {/* Header */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'flex-start',\n          }}>\n            <div>\n              <h2 style={{\n                margin: '0 0 4px 0',\n                fontSize: '20px',\n                fontWeight: 700,\n                color: '#eaf3ff',\n                lineHeight: '1.2',\n              }}>\n                {currentCard.name}\n              </h2>\n\n              <div style={{\n                fontSize: '12px',\n                color: '#6b7280',\n                fontWeight: 500,\n                display: 'flex',\n                gap: '8px',\n                alignItems: 'center',\n              }}>\n                <span>Karte {currentIndex + 1} von {sortedHand.length}</span>\n                <span style={{\n                  background: currentPlayer === 1 ? '#4ade80' : '#ef4444',\n                  color: 'white',\n                  padding: '2px 6px',\n                  borderRadius: '4px',\n                  fontSize: '10px',\n                  fontWeight: 600,\n                }}>\n                  P{currentPlayer}\n                </span>\n              </div>\n            </div>\n\n            <button\n              onClick={onClose}\n              style={{\n                background: 'none',\n                border: 'none',\n                color: '#8faecc',\n                fontSize: '20px',\n                cursor: 'pointer',\n                padding: '4px',\n                borderRadius: '4px',\n              }}\n            >\n              √ó\n            </button>\n          </div>\n\n          {/* Card Type and Cost */}\n          <div style={{\n            background: '#111827',\n            border: '1px solid #ffffff',\n            borderRadius: '8px',\n            padding: '12px',\n            fontSize: '12px',\n          }}>\n            <div style={{ color: '#9ca3af', marginBottom: '4px' }}>Typ & Kosten</div>\n            <div style={{ color: '#e5e7eb' }}>\n              {currentCard.kind === 'pol'\n                ? `Regierung/√ñffentlichkeit ‚Ä¢ ${convertHPToUSD((currentCard as PoliticianCard).BP || 0)}`\n                : `${(currentCard as SpecialCard).type} ‚Ä¢ ${convertHPToUSD((currentCard as SpecialCard).bp)}`\n              }\n            </div>\n            {/* Show subcategories for public cards */}\n            {cardDetails?.subcategories && cardDetails.subcategories.length > 0 && (\n              <div style={{ marginTop: '8px' }}>\n                <div style={{ color: '#9ca3af', marginBottom: '4px' }}>Schl√ºsselw√∂rter</div>\n                <div style={{ color: '#e5e7eb', fontSize: '11px' }}>\n                  {withIcons(cardDetails.subcategories.join(', '), 12)}\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* AP Breakdown */}\n          <div style={{\n            background: '#111827',\n            border: '1px solid #ffffff',\n            borderRadius: '8px',\n            padding: '12px',\n            fontSize: '12px',\n          }}>\n            <div style={{ color: '#9ca3af', marginBottom: '8px', fontWeight: '600' }}>AP-Kosten</div>\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n              color: '#e5e7eb',\n              marginBottom: '4px'\n            }}>\n              <span>Basis</span>\n              <span>\n                1 AP ‚Üí <strong>‚àí1</strong>\n              </span>\n            </div>\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n              color: '#e5e7eb',\n              marginBottom: '4px'\n            }}>\n              <span>Refunds</span>\n              <span>\n                <strong>+{1 - net}</strong>\n              </span>\n            </div>\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n              marginTop: '8px',\n              padding: '6px 8px',\n              background: net === 0 ? 'rgba(16, 185, 129, 0.1)' : 'rgba(245, 158, 11, 0.1)',\n              border: `1px solid ${net === 0 ? '#10b981' : '#f59e0b'}`,\n              borderRadius: '4px',\n              fontWeight: '600'\n            }}>\n              <span style={{ color: net === 0 ? '#10b981' : '#f59e0b' }}>Netto</span>\n              <span style={{ color: net === 0 ? '#10b981' : '#f59e0b' }}>\n                {net} AP {net === 0 ? '¬∑ verbraucht keine Aktion' : ''}\n              </span>\n            </div>\n          </div>\n\n          {/* Game Effect */}\n          <div style={{\n            background: '#111827',\n            border: '1px solid #ffffff',\n            borderRadius: '8px',\n            padding: '12px',\n            flex: 1,\n          }}>\n            <h3 style={{\n              margin: '0 0 8px 0',\n              fontSize: '14px',\n              fontWeight: 600,\n              color: '#e5e7eb',\n            }}>\n              Spieleffekt\n            </h3>\n            <p style={{\n              margin: 0,\n              color: '#d1d5db',\n              lineHeight: '1.4',\n              fontSize: '12px',\n            }}>\n              {cardDetails?.gameEffect ? withIcons(cardDetails.gameEffect, 14) : (currentCard.kind === 'spec'\n                ? (() => {\n                    const specCard = currentCard as SpecialCard;\n                    const baseSpecial = Specials.find(s => s.id === specCard.baseId);\n                    return baseSpecial?.effect || 'Keine Beschreibung verf√ºgbar';\n                  })()\n                : 'Politiker-F√§higkeiten basierend auf Tag')}\n            </p>\n          </div>\n\n          {/* Auto-Play Button */}\n          <button\n            disabled={!canPlay}\n            onClick={() => {\n              console.log('üîß DEBUG: Button clicked!');\n              handleAutoPlay();\n            }}\n            style={{\n              background: waitingForReplacement\n                ? 'linear-gradient(45deg, #f59e0b, #f97316)'\n                : canPlay\n                ? 'linear-gradient(45deg, #10b981, #059669)'\n                : 'linear-gradient(45deg, #6b7280, #4b5563)',\n              border: 'none',\n              borderRadius: '8px',\n              padding: '12px 16px',\n              color: 'white',\n              fontSize: '14px',\n              fontWeight: 'bold',\n              cursor: canPlay ? 'pointer' : 'not-allowed',\n              animation: canPlay ? 'pulse 2s infinite' : 'none',\n              boxShadow: canPlay ? '0 4px 16px rgba(16, 185, 129, 0.4)' : 'none',\n            }}\n          >\n            {waitingForReplacement\n              ? 'Karte zum Tauschen w√§hlen'\n              : canPlay\n              ? `Spielen (Netto ${net} AP)`\n              : 'Nicht spielbar'}\n          </button>\n\n          {/* Guard-Hinweis f√ºr detaillierte Begr√ºndung */}\n          {!canPlay && (\n            <div style={{\n              background: 'rgba(239, 68, 68, 0.1)',\n              border: '1px solid #ef4444',\n              borderRadius: '6px',\n              padding: '8px 12px',\n              color: '#f87171',\n              fontSize: '12px',\n              textAlign: 'center',\n            }}>\n              ‚ö†Ô∏è {(() => {\n                const currentAP = gameState.actionPoints[currentPlayer] ?? 0;\n                if (currentAP < net) {\n                  return `Zu wenig AP: ben√∂tigt ${net}, vorhanden ${currentAP}`;\n                }\n                if (actionsUsed >= 2 && net > 0) {\n                  return 'Nur Netto-0-Z√ºge erlaubt (Aktionslimit erreicht)';\n                }\n                return 'Karte kann nicht gespielt werden';\n              })()}\n            </div>\n          )}\n\n          {/* Info-Hinweis f√ºr 0-AP-Z√ºge */}\n          {onlyZeroApPossible && (\n            <div style={{\n              background: 'rgba(59, 130, 246, 0.1)',\n              border: '1px solid #3b82f6',\n              borderRadius: '6px',\n              padding: '8px 12px',\n              color: '#60a5fa',\n              fontSize: '12px',\n              textAlign: 'center',\n            }}>\n              0-AP-Zug verf√ºgbar ‚Äì spiele unbegrenzt viele Karten mit Netto 0 AP!\n            </div>\n          )}\n\n          {waitingForReplacement && (\n            <div style={{\n              fontSize: '11px',\n              color: '#f59e0b',\n              textAlign: 'center',\n              marginTop: '4px',\n            }}>\n              Slot ist voll - klicke auf eine Karte zum Ersetzen\n            </div>\n          )}\n        </div>\n      </div>\n\n      <style>{`\n        @keyframes pulse {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.05); }\n        }\n      `}</style>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}