{"ast":null,"code":"import{SpriteAnimator}from\"./spriteAnimator\";import{P1_PROJECTILE_SRC,P2_PROJECTILE_SRC}from\"./assetRegistry\";export class Projectile{constructor(x,y,vx,vy,owner,imgSrc,framesHint){var _a$rects$length,_a$rects;let atlasImage=arguments.length>7&&arguments[7]!==undefined?arguments[7]:null;let atlasRects=arguments.length>8&&arguments[8]!==undefined?arguments[8]:null;this.x=void 0;this.y=void 0;this.vx=void 0;this.vy=void 0;this.alive=true;this.age=0;this.lifespan=1.0;this.owner=void 0;this.anim=void 0;this.displayW=256;this.displayH=256;this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.owner=owner;const animationDef={src:imgSrc,frames:framesHint,fps:12,loop:true,frameW:256,frameH:256};if(atlasImage&&atlasRects){animationDef.image=atlasImage;animationDef.rects=atlasRects;animationDef.frames=atlasRects.length;animationDef.imageLoaded=true;animationDef.imageBroken=false;}this.anim=new SpriteAnimator(atlasImage,256,256,{fly:animationDef});this.anim.setState(\"fly\");// Simplified debug for fly animation\nconst a=this.anim.animations[\"fly\"];// eslint-disable-next-line no-console\nconsole.debug(\"[qte] projectile fly\",{frames:(_a$rects$length=a===null||a===void 0?void 0:(_a$rects=a.rects)===null||_a$rects===void 0?void 0:_a$rects.length)!==null&&_a$rects$length!==void 0?_a$rects$length:a===null||a===void 0?void 0:a.frames,hasRects:!!(a!==null&&a!==void 0&&a.rects)});}update(dt){this.age+=dt;this.x+=this.vx*dt;this.y+=this.vy*dt;this.anim.update(dt);if(this.age>=this.lifespan)this.alive=false;}draw(ctx){ctx.save();const alpha=Math.max(0,1-this.age/this.lifespan);ctx.globalAlpha=alpha;// Debug image load state if available\nconst a=this.anim.animations[\"fly\"];// eslint-disable-next-line no-console\nif(a&&a.image&&!a.image.complete)console.debug(\"[qte] projectile image not complete\",{src:a.src,complete:a.image.complete,broken:a.imageBroken});this.anim.draw(ctx,this.x,this.y,this.displayW,this.displayH,this.vx<0);ctx.restore();ctx.globalAlpha=1;}rect(){return{x:this.x,y:this.y,w:this.displayW,h:this.displayH};}}export class Blast{constructor(x,y,imgSrc,framesHint){let atlasImage=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let atlasRects=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;this.x=void 0;this.y=void 0;this.alive=true;this.timer=void 0;this.anim=void 0;this.w=256;this.h=256;this.x=x;this.y=y;this.timer=framesHint/12;const animationDef={src:imgSrc,frames:framesHint,fps:12,loop:false,frameW:256,frameH:256};if(atlasImage&&atlasRects){animationDef.image=atlasImage;animationDef.rects=atlasRects;animationDef.frames=atlasRects.length;animationDef.imageLoaded=true;animationDef.imageBroken=false;}this.anim=new SpriteAnimator(atlasImage,256,256,{boom:animationDef});this.anim.setState(\"boom\");}update(dt){this.timer-=dt;this.anim.update(dt);if(this.timer<=0)this.alive=false;}draw(ctx){this.anim.draw(ctx,this.x-this.w*0.5,this.y-this.h*0.5,this.w,this.h);}}export class Fighter{constructor(opts){var _opts$muzzleOffset;this.ctx=void 0;this.canvasW=void 0;this.canvasH=void 0;this.x=void 0;this.y=void 0;this.w=256;this.h=256;this.vx=0;this.vy=0;this.facing=1;this.hp=100;this.onGround=false;this.state=\"idle\";this.name=void 0;this.color=void 0;this.keys=void 0;this.anim=void 0;// action flags\nthis.attacking=false;this.parrying=false;this.ranging=false;this.attackLaunched=false;this.rangedLaunched=false;this.muzzleOffset=void 0;// timers\nthis.attackTimer=0;this.rangedTimer=0;this.parryTimer=0;this.parryFreezeTimer=0;this.stunTimer=0;this.parryConsumed=false;this.parryDurationDefault=0.4;this.parryWindowLength=this.parryDurationDefault*0.25;this.stunned=false;this.x=opts.x;this.y=opts.y;this.color=opts.color;this.keys=opts.keys;this.name=opts.name;this.ctx=opts.ctx;this.canvasW=opts.canvasWidth;this.canvasH=opts.canvasHeight;this.muzzleOffset=(_opts$muzzleOffset=opts.muzzleOffset)!==null&&_opts$muzzleOffset!==void 0?_opts$muzzleOffset:{x:36,y:-48};const img=new Image();img.src=opts.spriteConfig.animations.idle.src;this.anim=new SpriteAnimator(img,opts.spriteConfig.frameW,opts.spriteConfig.frameH,opts.spriteConfig.animations);this.anim.setState(\"idle\");}rect(){return{x:this.x,y:this.y,w:this.w,h:this.h};}hitbox(){if(this.state===\"attack\"){const aw=60,ah=40;const ax=this.facing>0?this.x+this.w-10:this.x-(aw-10);const ay=this.y+this.h*0.55-ah*0.5;return{x:ax,y:ay,w:aw,h:ah};}return null;}update(dt,input,projectiles){// Movement & gravity\nif(input[this.keys.left]){this.vx=-150;this.facing=-1;}else if(input[this.keys.right]){this.vx=150;this.facing=1;}else this.vx=0;if(this.onGround&&input[this.keys.up]){this.vy=-350;this.onGround=false;}this.vy+=900*dt;this.x+=this.vx*dt;this.y+=this.vy*dt;// ground collision\nif(this.y+this.h>=this.canvasH-40){this.y=this.canvasH-40-this.h;this.vy=0;this.onGround=true;}// Attack input\nif(input[this.keys.attack]&&!this.attacking){this.attacking=true;this.state=\"attack\";this.anim.setState(\"attack\");this.attackTimer=0.35;}if(this.attacking){this.attackTimer-=dt;if(this.attackTimer<=0)this.attacking=false;}// Ranged input\nif(input[this.keys.ranged]&&!this.ranging){this.ranging=true;this.state=\"ranged\";this.anim.setState(\"ranged\");this.rangedTimer=0.4;this.rangedLaunched=false;}if(this.ranging){this.rangedTimer-=dt;if(!this.rangedLaunched&&this.anim.state===\"ranged\"&&this.anim.frame===this.anim.animations[\"ranged\"].frames-1){this.rangedLaunched=true;// spawn point (muzzle) – use configured muzzleOffset (mirrored by facing)\nconst projW=256,projH=256;const muzzle=this.muzzleOffset||{x:36,y:-48};const centerX=this.x+this.w*0.5+muzzle.x*this.facing;const centerY=this.y+this.h*0.5+muzzle.y;const startX=Math.round(centerX-projW*0.5);const startY=Math.round(centerY-projH*0.5);const speed=600;const vx=this.facing>0?speed:-speed;const imgSrc=this.name===\"P1\"?P1_PROJECTILE_SRC:P2_PROJECTILE_SRC;// Use atlas for projectile if available\nlet projectileImage=null;let projectileRects=null;let projectileFrames=6;// Try to get atlas from owner's animator (will be set after atlas loads)\nif(this.anim&&this.anim.animations.projectile&&this.anim.animations.projectile.rects){projectileImage=this.anim.animations.projectile.image;projectileRects=this.anim.animations.projectile.rects;projectileFrames=this.anim.animations.projectile.rects.length;console.log(\"[qte] Projectile using atlas frames from \".concat(this.name));}else{console.log(\"[qte] Projectile: No atlas frames for 'projectile' in \".concat(this.name,\", falling back to individual image.\"));// If atlas isn't available yet, at least pass the already-preloaded per-animation image\nif(this.anim&&this.anim.animations.projectile&&this.anim.animations.projectile.image){projectileImage=this.anim.animations.projectile.image;console.log(\"[qte] Projectile: using per-animation image for \".concat(this.name));}}const proj=new Projectile(startX,startY,vx,0,this,imgSrc,projectileFrames,projectileImage,projectileRects);// Debug log projectile spawn\n// eslint-disable-next-line no-console\nconsole.debug(\"[qte] spawnProjectile\",{owner:this.name,startX,startY,imgSrc,facing:this.facing});const distanceToEdge=this.facing>0?this.canvasW-startX:startX;proj.lifespan=Math.min(1.2,Math.abs(distanceToEdge/speed));projectiles.push(proj);}if(this.rangedTimer<=0)this.ranging=false;}// State machine fallbacks\nif(!this.attacking&&!this.ranging){if(!this.onGround)this.setState(\"jump\");else if(Math.abs(this.vx)>1)this.setState(\"walk\");else this.setState(\"idle\");}// animator update\nthis.anim.update(dt);}draw(){this.anim.draw(this.ctx,this.x,this.y,this.w,this.h,this.facing<0);}setState(s){if(this.state===s)return;this.state=s;this.anim.setState(s);}}","map":{"version":3,"names":["SpriteAnimator","P1_PROJECTILE_SRC","P2_PROJECTILE_SRC","Projectile","constructor","x","y","vx","vy","owner","imgSrc","framesHint","_a$rects$length","_a$rects","atlasImage","arguments","length","undefined","atlasRects","alive","age","lifespan","anim","displayW","displayH","animationDef","src","frames","fps","loop","frameW","frameH","image","rects","imageLoaded","imageBroken","fly","setState","a","animations","console","debug","hasRects","update","dt","draw","ctx","save","alpha","Math","max","globalAlpha","complete","broken","restore","rect","w","h","Blast","timer","boom","Fighter","opts","_opts$muzzleOffset","canvasW","canvasH","facing","hp","onGround","state","name","color","keys","attacking","parrying","ranging","attackLaunched","rangedLaunched","muzzleOffset","attackTimer","rangedTimer","parryTimer","parryFreezeTimer","stunTimer","parryConsumed","parryDurationDefault","parryWindowLength","stunned","canvasWidth","canvasHeight","img","Image","spriteConfig","idle","hitbox","aw","ah","ax","ay","input","projectiles","left","right","up","attack","ranged","frame","projW","projH","muzzle","centerX","centerY","startX","round","startY","speed","projectileImage","projectileRects","projectileFrames","projectile","log","concat","proj","distanceToEdge","min","abs","push","s"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/qte/fighter.ts"],"sourcesContent":["import { SpriteAnimator } from \"./spriteAnimator\";\nimport {\n  P1_PROJECTILE_SRC,\n  P2_PROJECTILE_SRC,\n  P1_BLAST_SRC,\n  P2_BLAST_SRC,\n} from \"./assetRegistry\";\n\nexport interface Rect {\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n}\n\nexport interface FighterOptions {\n  x: number;\n  y: number;\n  color: string;\n  keys: Record<string, string>; // keycodes mapping\n  name: string;\n  spriteConfig: { frameW: number; frameH: number; animations: any };\n  ctx: CanvasRenderingContext2D;\n  canvasWidth: number;\n  canvasHeight: number;\n  muzzleOffset?: { x: number; y: number };\n}\n\nexport class Projectile {\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  alive = true;\n  age = 0;\n  lifespan = 1.0;\n  owner: Fighter;\n  anim: SpriteAnimator;\n  displayW = 256;\n  displayH = 256;\n\n  constructor(\n    x: number,\n    y: number,\n    vx: number,\n    vy: number,\n    owner: Fighter,\n    imgSrc: string,\n    framesHint: number,\n    atlasImage: HTMLImageElement | null = null,\n    atlasRects: Rect[] | null = null\n  ) {\n    this.x = x;\n    this.y = y;\n    this.vx = vx;\n    this.vy = vy;\n    this.owner = owner;\n    const animationDef: any = {\n      src: imgSrc,\n      frames: framesHint,\n      fps: 12,\n      loop: true,\n      frameW: 256,\n      frameH: 256,\n    };\n\n    if (atlasImage && atlasRects) {\n      animationDef.image = atlasImage;\n      animationDef.rects = atlasRects;\n      animationDef.frames = atlasRects.length;\n      animationDef.imageLoaded = true;\n      animationDef.imageBroken = false;\n    }\n\n    this.anim = new SpriteAnimator(atlasImage, 256, 256, {\n      fly: animationDef,\n    });\n    this.anim.setState(\"fly\");\n    // Simplified debug for fly animation\n    const a = this.anim.animations[\"fly\"];\n    // eslint-disable-next-line no-console\n    console.debug(\"[qte] projectile fly\", { frames: a?.rects?.length ?? a?.frames, hasRects: !!a?.rects });\n  }\n\n  update(dt: number) {\n    this.age += dt;\n    this.x += this.vx * dt;\n    this.y += this.vy * dt;\n    this.anim.update(dt);\n    if (this.age >= this.lifespan) this.alive = false;\n  }\n  draw(ctx: CanvasRenderingContext2D) {\n    ctx.save();\n    const alpha = Math.max(0, 1 - this.age / this.lifespan);\n    ctx.globalAlpha = alpha;\n    // Debug image load state if available\n    const a = this.anim.animations[\"fly\"];\n    // eslint-disable-next-line no-console\n    if (a && a.image && !a.image.complete) console.debug(\"[qte] projectile image not complete\", { src: a.src, complete: a.image.complete, broken: a.imageBroken });\n    this.anim.draw(ctx, this.x, this.y, this.displayW, this.displayH, this.vx < 0);\n    ctx.restore();\n    ctx.globalAlpha = 1;\n  }\n  rect(): Rect {\n    return { x: this.x, y: this.y, w: this.displayW, h: this.displayH };\n  }\n}\n\nexport class Blast {\n  x: number;\n  y: number;\n  alive = true;\n  timer: number;\n  anim: SpriteAnimator;\n  w = 256;\n  h = 256;\n  constructor(x: number, y: number, imgSrc: string, framesHint: number, atlasImage: HTMLImageElement | null = null, atlasRects: Rect[] | null = null) {\n    this.x = x;\n    this.y = y;\n    this.timer = framesHint / 12;\n\n    const animationDef: any = {\n      src: imgSrc,\n      frames: framesHint,\n      fps: 12,\n      loop: false,\n      frameW: 256,\n      frameH: 256,\n    };\n\n    if (atlasImage && atlasRects) {\n      animationDef.image = atlasImage;\n      animationDef.rects = atlasRects;\n      animationDef.frames = atlasRects.length;\n      animationDef.imageLoaded = true;\n      animationDef.imageBroken = false;\n    }\n\n    this.anim = new SpriteAnimator(atlasImage, 256, 256, {\n      boom: animationDef,\n    });\n    this.anim.setState(\"boom\");\n  }\n  update(dt: number) {\n    this.timer -= dt;\n    this.anim.update(dt);\n    if (this.timer <= 0) this.alive = false;\n  }\n  draw(ctx: CanvasRenderingContext2D) {\n    this.anim.draw(ctx, this.x - this.w * 0.5, this.y - this.h * 0.5, this.w, this.h);\n  }\n}\n\nexport class Fighter {\n  private ctx: CanvasRenderingContext2D;\n  private canvasW: number;\n  private canvasH: number;\n\n  x: number;\n  y: number;\n  w = 256;\n  h = 256;\n  vx = 0;\n  vy = 0;\n  facing = 1;\n  hp = 100;\n  onGround = false;\n\n  state: string = \"idle\";\n  name: string;\n  color: string;\n  keys: Record<string, string>;\n  anim: SpriteAnimator;\n\n  // action flags\n  attacking = false;\n  parrying = false;\n  ranging = false;\n  attackLaunched = false;\n  rangedLaunched = false;\n  muzzleOffset: { x: number; y: number };\n\n  // timers\n  attackTimer = 0;\n  rangedTimer = 0;\n  parryTimer = 0;\n  parryFreezeTimer = 0;\n  stunTimer = 0;\n  parryConsumed = false;\n  parryDurationDefault = 0.4;\n  parryWindowLength = this.parryDurationDefault * 0.25;\n  stunned = false;\n\n  constructor(opts: FighterOptions) {\n    this.x = opts.x;\n    this.y = opts.y;\n    this.color = opts.color;\n    this.keys = opts.keys;\n    this.name = opts.name;\n    this.ctx = opts.ctx;\n    this.canvasW = opts.canvasWidth;\n    this.canvasH = opts.canvasHeight;\n    this.muzzleOffset = opts.muzzleOffset ?? { x: 36, y: -48 };\n\n    const img = new Image();\n    img.src = opts.spriteConfig.animations.idle.src;\n    this.anim = new SpriteAnimator(img, opts.spriteConfig.frameW, opts.spriteConfig.frameH, opts.spriteConfig.animations);\n    this.anim.setState(\"idle\");\n  }\n\n  rect(): Rect {\n    return { x: this.x, y: this.y, w: this.w, h: this.h };\n  }\n\n  hitbox(): Rect | null {\n    if (this.state === \"attack\") {\n      const aw = 60,\n        ah = 40;\n      const ax = this.facing > 0 ? this.x + this.w - 10 : this.x - (aw - 10);\n      const ay = this.y + this.h * 0.55 - ah * 0.5;\n      return { x: ax, y: ay, w: aw, h: ah };\n    }\n    return null;\n  }\n\n  update(dt: number, input: Record<string, boolean>, projectiles: Projectile[]) {\n    // Movement & gravity\n    if (input[this.keys.left]) {\n      this.vx = -150;\n      this.facing = -1;\n    } else if (input[this.keys.right]) {\n      this.vx = 150;\n      this.facing = 1;\n    } else this.vx = 0;\n    if (this.onGround && input[this.keys.up]) {\n      this.vy = -350;\n      this.onGround = false;\n    }\n    this.vy += 900 * dt;\n    this.x += this.vx * dt;\n    this.y += this.vy * dt;\n\n    // ground collision\n    if (this.y + this.h >= this.canvasH - 40) {\n      this.y = this.canvasH - 40 - this.h;\n      this.vy = 0;\n      this.onGround = true;\n    }\n\n    // Attack input\n    if (input[this.keys.attack] && !this.attacking) {\n      this.attacking = true;\n      this.state = \"attack\";\n      this.anim.setState(\"attack\");\n      this.attackTimer = 0.35;\n    }\n    if (this.attacking) {\n      this.attackTimer -= dt;\n      if (this.attackTimer <= 0) this.attacking = false;\n    }\n\n    // Ranged input\n    if (input[this.keys.ranged] && !this.ranging) {\n      this.ranging = true;\n      this.state = \"ranged\";\n      this.anim.setState(\"ranged\");\n      this.rangedTimer = 0.4;\n      this.rangedLaunched = false;\n    }\n    if (this.ranging) {\n      this.rangedTimer -= dt;\n      if (!this.rangedLaunched && this.anim.state === \"ranged\" && this.anim.frame === this.anim.animations[\"ranged\"].frames - 1) {\n        this.rangedLaunched = true;\n        // spawn point (muzzle) – use configured muzzleOffset (mirrored by facing)\n        const projW = 256, projH = 256;\n        const muzzle = this.muzzleOffset || { x: 36, y: -48 };\n        const centerX = this.x + this.w * 0.5 + muzzle.x * this.facing;\n        const centerY = this.y + this.h * 0.5 + muzzle.y;\n        const startX = Math.round(centerX - projW * 0.5);\n        const startY = Math.round(centerY - projH * 0.5);\n        const speed = 600;\n        const vx = this.facing > 0 ? speed : -speed;\n        const imgSrc = this.name === \"P1\" ? P1_PROJECTILE_SRC : P2_PROJECTILE_SRC;\n        // Use atlas for projectile if available\n        let projectileImage = null;\n        let projectileRects = null;\n        let projectileFrames = 6;\n\n        // Try to get atlas from owner's animator (will be set after atlas loads)\n        if (this.anim && this.anim.animations.projectile && this.anim.animations.projectile.rects) {\n          projectileImage = this.anim.animations.projectile.image;\n          projectileRects = this.anim.animations.projectile.rects;\n          projectileFrames = this.anim.animations.projectile.rects.length;\n          console.log(`[qte] Projectile using atlas frames from ${this.name}`);\n        } else {\n          console.log(`[qte] Projectile: No atlas frames for 'projectile' in ${this.name}, falling back to individual image.`);\n          // If atlas isn't available yet, at least pass the already-preloaded per-animation image\n          if (this.anim && this.anim.animations.projectile && this.anim.animations.projectile.image) {\n            projectileImage = this.anim.animations.projectile.image;\n            console.log(`[qte] Projectile: using per-animation image for ${this.name}`);\n          }\n        }\n\n        const proj = new Projectile(startX, startY, vx, 0, this, imgSrc, projectileFrames, projectileImage, projectileRects);\n        // Debug log projectile spawn\n        // eslint-disable-next-line no-console\n        console.debug(\"[qte] spawnProjectile\", { owner: this.name, startX, startY, imgSrc, facing: this.facing });\n        const distanceToEdge = this.facing > 0 ? this.canvasW - startX : startX;\n        proj.lifespan = Math.min(1.2, Math.abs(distanceToEdge / speed));\n        projectiles.push(proj);\n      }\n      if (this.rangedTimer <= 0) this.ranging = false;\n    }\n\n    // State machine fallbacks\n    if (!this.attacking && !this.ranging) {\n      if (!this.onGround) this.setState(\"jump\");\n      else if (Math.abs(this.vx) > 1) this.setState(\"walk\");\n      else this.setState(\"idle\");\n    }\n\n    // animator update\n    this.anim.update(dt);\n  }\n\n  draw() {\n    this.anim.draw(this.ctx, this.x, this.y, this.w, this.h, this.facing < 0);\n  }\n\n  private setState(s: string) {\n    if (this.state === s) return;\n    this.state = s;\n    this.anim.setState(s);\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}