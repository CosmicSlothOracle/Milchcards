{"ast":null,"code":"import React,{useEffect,useRef,useImperativeHandle,forwardRef}from'react';import*as THREE from'three';import{gsap}from'gsap';import{jsx as _jsx}from\"react/jsx-runtime\";/**\n * Dice3D – simple WebGL dice rendered with three.js\n * Usage:\n *   const diceRef = useRef<Dice3DHandle>(null);\n *   <Dice3D ref={diceRef} onRoll={(f)=>console.log(f)}/>\n *   diceRef.current?.roll();\n */const Dice3D=/*#__PURE__*/forwardRef((_ref,ref)=>{let{size=180,duration=1200,onRoll,className,spinOnly=true}=_ref;const canvasRef=useRef(null);const sceneRef=useRef();const cubeRef=useRef();const rendererRef=useRef();const cameraRef=useRef();const animIdRef=useRef(0);/** helper to create a texture with pips */const createFaceTexture=face=>{const size=128;const cvs=document.createElement('canvas');cvs.width=cvs.height=size;const ctx=cvs.getContext('2d');ctx.fillStyle='#fff';ctx.fillRect(0,0,size,size);ctx.fillStyle='#111';const dot=(x,y)=>{ctx.beginPath();ctx.arc(x,y,size*0.1,0,Math.PI*2);ctx.fill();};const g=size*0.25;const centers={1:[[size/2,size/2]],2:[[g,g],[size-g,size-g]],3:[[g,g],[size/2,size/2],[size-g,size-g]],4:[[g,g],[size-g,g],[g,size-g],[size-g,size-g]],5:[[g,g],[size-g,g],[size/2,size/2],[g,size-g],[size-g,size-g]],6:[[g,g],[size-g,g],[g,size/2],[size-g,size/2],[g,size-g],[size-g,size-g]]};centers[face].forEach(_ref2=>{let[x,y]=_ref2;return dot(x,y);});const tex=new THREE.CanvasTexture(cvs);tex.needsUpdate=true;return tex;};// initialize three scene\nuseEffect(()=>{const canvas=canvasRef.current;if(!canvas)return;const scene=new THREE.Scene();scene.background=new THREE.Color(0x000000);const camera=new THREE.PerspectiveCamera(45,1,0.1,1000);camera.position.z=4;const renderer=new THREE.WebGLRenderer({canvas,antialias:true,alpha:true});renderer.setSize(size,size);renderer.shadowMap.enabled=true;renderer.shadowMap.type=THREE.PCFSoftShadowMap;// lights\nconst ambient=new THREE.AmbientLight(0xffffff,0.6);scene.add(ambient);const dir=new THREE.DirectionalLight(0xffffff,1.0);dir.position.set(5,10,7);dir.castShadow=true;dir.shadow.mapSize.width=1024;dir.shadow.mapSize.height=1024;dir.shadow.camera.left=-5;dir.shadow.camera.right=5;dir.shadow.camera.top=5;dir.shadow.camera.bottom=-5;scene.add(dir);// ground plane to receive shadow\nconst planeGeo=new THREE.PlaneGeometry(10,10);const planeMat=new THREE.ShadowMaterial({opacity:0.35});const plane=new THREE.Mesh(planeGeo,planeMat);plane.rotation.x=-Math.PI/2;plane.position.y=-1.1;plane.receiveShadow=true;scene.add(plane);// Create a simple procedural equirectangular-like texture for subtle reflections\nlet generatedEnvMap=null;try{const envCanvas=document.createElement('canvas');envCanvas.width=envCanvas.height=256;const ectx=envCanvas.getContext('2d');// simple radial gradient\nconst grad=ectx.createRadialGradient(128,128,20,128,128,140);grad.addColorStop(0,'#ffffff');grad.addColorStop(0.5,'#ccccff');grad.addColorStop(1,'#556688');ectx.fillStyle=grad;ectx.fillRect(0,0,256,256);const envTex=new THREE.CanvasTexture(envCanvas);envTex.mapping=THREE.EquirectangularReflectionMapping;const pmremGen=new THREE.PMREMGenerator(renderer);pmremGen.compileEquirectangularShader();generatedEnvMap=pmremGen.fromEquirectangular(envTex).texture;scene.environment=generatedEnvMap;}catch(e){// ignore if PMREM not supported in environment\ngeneratedEnvMap=null;}// cube\nconst materials=[1,2,3,4,5,6].map(f=>new THREE.MeshStandardMaterial({map:createFaceTexture(f),metalness:0.4,roughness:0.25,envMapIntensity:1.0}));const geometry=new THREE.BoxGeometry(2,2,2);const cube=new THREE.Mesh(geometry,materials);cube.castShadow=true;cube.receiveShadow=false;scene.add(cube);// If we generated an environment map, apply it to materials for reflections\nif(generatedEnvMap){try{materials.forEach(m=>{m.envMap=generatedEnvMap;m.envMapIntensity=0.8;m.needsUpdate=true;});}catch(e){}}sceneRef.current=scene;cubeRef.current=cube;rendererRef.current=renderer;cameraRef.current=camera;// Ensure canvas is anchored bottom-right and has no initial transform\ntry{const el=canvas;el.style.position='fixed';el.style.right='20px';el.style.bottom='20px';el.style.left='';el.style.top='';el.style.transform='';el.style.transition='';}catch(e){}// animation loop\n// previous rotation for motion-blur estimation\nconst prevRot={x:0,y:0,z:0};const animate=()=>{animIdRef.current=requestAnimationFrame(animate);// subtle idle rotate\nif(cube){cube.rotation.x*=0.995;cube.rotation.y*=0.995;// compute angular velocity\nconst dx=cube.rotation.x-prevRot.x;const dy=cube.rotation.y-prevRot.y;const dz=cube.rotation.z-prevRot.z;const angSpeed=Math.sqrt(dx*dx+dy*dy+dz*dz);// map angular speed to CSS blur (px)\nconst blurPx=Math.min(12,angSpeed*120);try{const el=canvas;if(el&&el.style){el.style.filter=blurPx>0.3?\"blur(\".concat(blurPx.toFixed(2),\"px)\"):'none';}}catch(e){}prevRot.x=cube.rotation.x;prevRot.y=cube.rotation.y;prevRot.z=cube.rotation.z;}renderer.render(scene,camera);};animate();return()=>{cancelAnimationFrame(animIdRef.current);renderer.dispose();};},[size]);// roll logic (includes DOM motion)\nconst rollInternal=targetFace=>{if(!cubeRef.current)return;const cube=cubeRef.current;// pick target if not provided\nconst face=targetFace!==null&&targetFace!==void 0?targetFace:1+Math.floor(Math.random()*6);// orientation map: face -> Euler rotation (approx)\nconst orientations={1:[0,0,0],2:[0,Math.PI/2,0],3:[-Math.PI/2,0,0],4:[Math.PI/2,0,0],5:[0,-Math.PI/2,0],6:[Math.PI,0,0]};const[tx,ty,tz]=orientations[face];const start={x:cube.rotation.x,y:cube.rotation.y,z:cube.rotation.z};const end={x:tx+2*Math.PI,y:ty+2*Math.PI,z:tz+2*Math.PI};// Use GSAP timeline for smooth rotation + bounces and DOM motion\nconst timeline=gsap.timeline({onComplete:()=>{cube.rotation.set(tx,ty,tz);if(onRoll)onRoll(face);}});// ensure any previous tweens are cleared and canvas anchored bottom-right\nconst canvasEl=canvasRef.current;if(canvasEl){try{gsap.killTweensOf(canvasEl);}catch(e){}try{canvasEl.style.transform='';canvasEl.style.transition='';canvasEl.style.left='';canvasEl.style.top='';canvasEl.style.right='20px';canvasEl.style.bottom='20px';canvasEl.style.willChange='auto';}catch(e){}}if(spinOnly){// keep canvas fixed bottom-right with no transform\nif(canvasEl&&canvasEl.style){gsap.set(canvasEl,{x:0,y:0,filter:'blur(0px)'});canvasEl.style.right='20px';canvasEl.style.bottom='20px';}}else{// physics-like multi-bounce motion across screen\nif(canvasEl&&canvasEl.style){canvasEl.style.position='fixed';canvasEl.style.left='0px';canvasEl.style.top='0px';canvasEl.style.willChange='transform, filter';// initial velocity and angle\nconst speedBase=Math.max(200,duration*0.6);// px per second scale\nconst angle=Math.random()*Math.PI*2;let vx=Math.cos(angle)*(speedBase*(0.6+Math.random()*0.8));let vy=Math.sin(angle)*(speedBase*(0.6+Math.random()*0.8));// start position: bottom-right corner with small margin\nconst margin=20;const startX=Math.max(0,window.innerWidth-size-margin);const startY=Math.max(0,window.innerHeight-size-margin);let x=startX;let y=startY;gsap.set(canvasEl,{x,y,filter:'blur(0px)'});// final target: within 100px radius around screen center\nconst centerX=Math.round(window.innerWidth/2-size/2);const centerY=Math.round(window.innerHeight/2-size/2);const radius=100;const angT=Math.random()*Math.PI*2;const endX=Math.max(0,Math.min(window.innerWidth-size,centerX+Math.cos(angT)*(Math.random()*radius)));const endY=Math.max(0,Math.min(window.innerHeight-size,centerY+Math.sin(angT)*(Math.random()*radius)));// generate bounces until energy low or max 6 bounces\nconst bounces=[];let energy=Math.hypot(vx,vy);const damp=0.45+Math.random()*0.18;// energy retention per bounce\nconst maxBounces=6;for(let i=0;i<maxBounces&&energy>80;i++){// project next position with simple friction\nconst dt=duration/1000*(0.25+Math.random()*0.35);const nx=x+vx*dt;const ny=y+vy*dt+200*(Math.random()-0.5)*0.1;// slight gravity variation\nconst dur=Math.max(0.06,dt*(0.6+Math.random()*0.6));const blur=Math.min(6,energy/200);bounces.push({nx,ny,dur,blur});// update for next\nx=nx;y=ny;energy*=damp*(0.8+Math.random()*0.4);// random angle change\nconst angChange=(Math.random()-0.5)*0.8;const vAngle=Math.atan2(vy,vx)+angChange;const vMag=energy;vx=Math.cos(vAngle)*vMag*0.02;vy=Math.sin(vAngle)*vMag*0.02;}// schedule bounces in timeline\nlet tOffset=0;for(const b of bounces){timeline.to(canvasEl,{duration:b.dur,x:b.nx,y:b.ny,ease:'power2.out'},tOffset);timeline.to(canvasEl,{duration:b.dur,filter:\"blur(\".concat(b.blur,\"px)\")},tOffset);tOffset+=b.dur*0.9;}// final settle to the computed center-target\ntimeline.to(canvasEl,{duration:0.12,x:endX,y:endY,ease:'power1.out'},'>-0.02');timeline.to(canvasEl,{duration:0.12,filter:'blur(0px)',ease:'power1.out'},'>-0.02');}}// rotation: spin multiple revolutions then ease to final orientation\n// we'll use a GSAP ticker to update cube.rotation\nconst totalSpins=3+Math.floor(Math.random()*4);const rotEnd={x:end.x,y:end.y,z:end.z};const rotStart={x:start.x,y:start.y,z:start.z};// animate rotation using timeline with an onUpdate that writes to cube\nlet progress={t:0};timeline.to(progress,{t:1,duration:duration/1000,ease:'power3.out',onUpdate:()=>{const k=progress.t;// combine ease with extra spins\nconst spinFactor=1-Math.pow(1-k,3);const currentX=rotStart.x+(rotEnd.x-rotStart.x)*k+totalSpins*Math.PI*2*(1-(1-k));const currentY=rotStart.y+(rotEnd.y-rotStart.y)*k+totalSpins*Math.PI*2*(1-(1-k));const currentZ=rotStart.z+(rotEnd.z-rotStart.z)*k+totalSpins*Math.PI*2*(1-(1-k));cube.rotation.set(currentX,currentY,currentZ);}});// small multi-bounce sequence on completion (scale + tilt)\ntimeline.to(cube.scale,{x:1.08,y:0.90,z:0.9,duration:0.07,ease:'power2.out'},'>-0.05');timeline.to(cube.scale,{x:0.95,y:1.07,z:0.95,duration:0.06,ease:'power2.in'});timeline.to(cube.scale,{x:1.03,y:0.98,z:1.02,duration:0.05,ease:'power2.out'});timeline.to(cube.scale,{x:1,y:1,z:1,duration:0.04,ease:'power2.out'});};useImperativeHandle(ref,()=>({roll:()=>rollInternal(),rollTo:face=>rollInternal(Math.max(1,Math.min(6,face)))}),[duration,onRoll]);// click to roll\nuseEffect(()=>{const canvas=canvasRef.current;if(!canvas)return;const handler=()=>rollInternal();canvas.addEventListener('click',handler);return()=>canvas.removeEventListener('click',handler);},[]);return/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:size,height:size,className:className,style:{cursor:'pointer'}});});export default Dice3D;","map":{"version":3,"names":["React","useEffect","useRef","useImperativeHandle","forwardRef","THREE","gsap","jsx","_jsx","Dice3D","_ref","ref","size","duration","onRoll","className","spinOnly","canvasRef","sceneRef","cubeRef","rendererRef","cameraRef","animIdRef","createFaceTexture","face","cvs","document","createElement","width","height","ctx","getContext","fillStyle","fillRect","dot","x","y","beginPath","arc","Math","PI","fill","g","centers","forEach","_ref2","tex","CanvasTexture","needsUpdate","canvas","current","scene","Scene","background","Color","camera","PerspectiveCamera","position","z","renderer","WebGLRenderer","antialias","alpha","setSize","shadowMap","enabled","type","PCFSoftShadowMap","ambient","AmbientLight","add","dir","DirectionalLight","set","castShadow","shadow","mapSize","left","right","top","bottom","planeGeo","PlaneGeometry","planeMat","ShadowMaterial","opacity","plane","Mesh","rotation","receiveShadow","generatedEnvMap","envCanvas","ectx","grad","createRadialGradient","addColorStop","envTex","mapping","EquirectangularReflectionMapping","pmremGen","PMREMGenerator","compileEquirectangularShader","fromEquirectangular","texture","environment","e","materials","map","f","MeshStandardMaterial","metalness","roughness","envMapIntensity","geometry","BoxGeometry","cube","m","envMap","el","style","transform","transition","prevRot","animate","requestAnimationFrame","dx","dy","dz","angSpeed","sqrt","blurPx","min","filter","concat","toFixed","render","cancelAnimationFrame","dispose","rollInternal","targetFace","floor","random","orientations","tx","ty","tz","start","end","timeline","onComplete","canvasEl","killTweensOf","willChange","speedBase","max","angle","vx","cos","vy","sin","margin","startX","window","innerWidth","startY","innerHeight","centerX","round","centerY","radius","angT","endX","endY","bounces","energy","hypot","damp","maxBounces","i","dt","nx","ny","dur","blur","push","angChange","vAngle","atan2","vMag","tOffset","b","to","ease","totalSpins","rotEnd","rotStart","progress","t","onUpdate","k","spinFactor","pow","currentX","currentY","currentZ","scale","roll","rollTo","handler","addEventListener","removeEventListener","cursor"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/components/Dice3D.tsx"],"sourcesContent":["import React, { useEffect, useRef, useImperativeHandle, forwardRef } from 'react';\nimport * as THREE from 'three';\nimport { gsap } from 'gsap';\n\nexport interface Dice3DProps {\n  /** pixel size of canvas */\n  size?: number;\n  /** roll animation duration in ms */\n  duration?: number;\n  /** callback when roll ends */\n  onRoll?: (face: number) => void;\n  className?: string;\n  /** if true, only spin in place; if false, do screen bounces */\n  spinOnly?: boolean;\n}\n\nexport interface Dice3DHandle {\n  roll: () => void;\n  rollTo: (face: number) => void;\n}\n\n/**\n * Dice3D – simple WebGL dice rendered with three.js\n * Usage:\n *   const diceRef = useRef<Dice3DHandle>(null);\n *   <Dice3D ref={diceRef} onRoll={(f)=>console.log(f)}/>\n *   diceRef.current?.roll();\n */\nconst Dice3D = forwardRef<Dice3DHandle, Dice3DProps>(\n  ({ size = 180, duration = 1200, onRoll, className, spinOnly = true }: Dice3DProps, ref) => {\n    const canvasRef = useRef<HTMLCanvasElement | null>(null);\n    const sceneRef = useRef<THREE.Scene>();\n    const cubeRef = useRef<THREE.Mesh>();\n    const rendererRef = useRef<THREE.WebGLRenderer>();\n    const cameraRef = useRef<THREE.PerspectiveCamera>();\n    const animIdRef = useRef(0);\n\n    /** helper to create a texture with pips */\n    const createFaceTexture = (face: number): THREE.Texture => {\n      const size = 128;\n      const cvs = document.createElement('canvas');\n      cvs.width = cvs.height = size;\n      const ctx = cvs.getContext('2d')!;\n      ctx.fillStyle = '#fff';\n      ctx.fillRect(0, 0, size, size);\n      ctx.fillStyle = '#111';\n\n      const dot = (x: number, y: number) => {\n        ctx.beginPath();\n        ctx.arc(x, y, size * 0.1, 0, Math.PI * 2);\n        ctx.fill();\n      };\n      const g = size * 0.25;\n      const centers: Record<number, Array<[number, number]>> = {\n        1: [[size / 2, size / 2]],\n        2: [[g, g], [size - g, size - g]],\n        3: [[g, g], [size / 2, size / 2], [size - g, size - g]],\n        4: [[g, g], [size - g, g], [g, size - g], [size - g, size - g]],\n        5: [[g, g], [size - g, g], [size / 2, size / 2], [g, size - g], [size - g, size - g]],\n        6: [[g, g], [size - g, g], [g, size / 2], [size - g, size / 2], [g, size - g], [size - g, size - g]],\n      };\n      centers[face].forEach(([x, y]) => dot(x, y));\n      const tex = new THREE.CanvasTexture(cvs);\n      tex.needsUpdate = true;\n      return tex;\n    };\n\n    // initialize three scene\n    useEffect(() => {\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      const scene = new THREE.Scene();\n      scene.background = new THREE.Color(0x000000);\n      const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 1000);\n      camera.position.z = 4;\n      const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });\n      renderer.setSize(size, size);\n      renderer.shadowMap.enabled = true;\n      renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\n      // lights\n      const ambient = new THREE.AmbientLight(0xffffff, 0.6);\n      scene.add(ambient);\n      const dir = new THREE.DirectionalLight(0xffffff, 1.0);\n      dir.position.set(5, 10, 7);\n      dir.castShadow = true;\n      dir.shadow.mapSize.width = 1024;\n      dir.shadow.mapSize.height = 1024;\n      dir.shadow.camera.left = -5;\n      dir.shadow.camera.right = 5;\n      dir.shadow.camera.top = 5;\n      dir.shadow.camera.bottom = -5;\n      scene.add(dir);\n\n      // ground plane to receive shadow\n      const planeGeo = new THREE.PlaneGeometry(10, 10);\n      const planeMat = new THREE.ShadowMaterial({ opacity: 0.35 });\n      const plane = new THREE.Mesh(planeGeo, planeMat);\n      plane.rotation.x = -Math.PI / 2;\n      plane.position.y = -1.1;\n      plane.receiveShadow = true;\n      scene.add(plane);\n\n      // Create a simple procedural equirectangular-like texture for subtle reflections\n      let generatedEnvMap: THREE.Texture | null = null;\n      try {\n        const envCanvas = document.createElement('canvas');\n        envCanvas.width = envCanvas.height = 256;\n        const ectx = envCanvas.getContext('2d')!;\n        // simple radial gradient\n        const grad = ectx.createRadialGradient(128, 128, 20, 128, 128, 140);\n        grad.addColorStop(0, '#ffffff');\n        grad.addColorStop(0.5, '#ccccff');\n        grad.addColorStop(1, '#556688');\n        ectx.fillStyle = grad;\n        ectx.fillRect(0, 0, 256, 256);\n        const envTex = new THREE.CanvasTexture(envCanvas);\n        envTex.mapping = THREE.EquirectangularReflectionMapping;\n        const pmremGen = new THREE.PMREMGenerator(renderer);\n        pmremGen.compileEquirectangularShader();\n        generatedEnvMap = pmremGen.fromEquirectangular(envTex).texture;\n        scene.environment = generatedEnvMap;\n      } catch (e) {\n        // ignore if PMREM not supported in environment\n        generatedEnvMap = null;\n      }\n\n      // cube\n      const materials = [1, 2, 3, 4, 5, 6].map(f => new THREE.MeshStandardMaterial({ map: createFaceTexture(f), metalness: 0.4, roughness: 0.25, envMapIntensity: 1.0 }));\n      const geometry = new THREE.BoxGeometry(2, 2, 2);\n      const cube = new THREE.Mesh(geometry, materials);\n      cube.castShadow = true;\n      cube.receiveShadow = false;\n      scene.add(cube);\n\n      // If we generated an environment map, apply it to materials for reflections\n      if (generatedEnvMap) {\n        try {\n          materials.forEach((m: any) => {\n            m.envMap = generatedEnvMap;\n            m.envMapIntensity = 0.8;\n            m.needsUpdate = true;\n          });\n        } catch (e) {}\n      }\n\n      sceneRef.current = scene;\n      cubeRef.current = cube;\n      rendererRef.current = renderer;\n      cameraRef.current = camera;\n\n      // Ensure canvas is anchored bottom-right and has no initial transform\n      try {\n        const el = canvas as HTMLCanvasElement;\n        el.style.position = 'fixed';\n        el.style.right = '20px';\n        el.style.bottom = '20px';\n        el.style.left = '';\n        el.style.top = '';\n        el.style.transform = '';\n        el.style.transition = '';\n      } catch (e) {}\n\n      // animation loop\n      // previous rotation for motion-blur estimation\n      const prevRot = { x: 0, y: 0, z: 0 };\n      const animate = () => {\n        animIdRef.current = requestAnimationFrame(animate);\n        // subtle idle rotate\n        if (cube) {\n          cube.rotation.x *= 0.995;\n          cube.rotation.y *= 0.995;\n\n          // compute angular velocity\n          const dx = cube.rotation.x - prevRot.x;\n          const dy = cube.rotation.y - prevRot.y;\n          const dz = cube.rotation.z - prevRot.z;\n          const angSpeed = Math.sqrt(dx * dx + dy * dy + dz * dz);\n\n          // map angular speed to CSS blur (px)\n          const blurPx = Math.min(12, angSpeed * 120);\n          try {\n            const el = canvas as HTMLCanvasElement;\n            if (el && el.style) {\n              el.style.filter = blurPx > 0.3 ? `blur(${blurPx.toFixed(2)}px)` : 'none';\n            }\n          } catch (e) {}\n\n          prevRot.x = cube.rotation.x;\n          prevRot.y = cube.rotation.y;\n          prevRot.z = cube.rotation.z;\n        }\n        renderer.render(scene, camera);\n      };\n      animate();\n\n      return () => {\n        cancelAnimationFrame(animIdRef.current);\n        renderer.dispose();\n      };\n    }, [size]);\n\n    // roll logic (includes DOM motion)\n    const rollInternal = (targetFace?: number) => {\n      if (!cubeRef.current) return;\n      const cube = cubeRef.current;\n      // pick target if not provided\n      const face = targetFace ?? (1 + Math.floor(Math.random() * 6));\n\n      // orientation map: face -> Euler rotation (approx)\n      const orientations: Record<number, [number, number, number]> = {\n        1: [0, 0, 0],\n        2: [0, Math.PI / 2, 0],\n        3: [-Math.PI / 2, 0, 0],\n        4: [Math.PI / 2, 0, 0],\n        5: [0, -Math.PI / 2, 0],\n        6: [Math.PI, 0, 0],\n      };\n      const [tx, ty, tz] = orientations[face];\n\n      const start = { x: cube.rotation.x, y: cube.rotation.y, z: cube.rotation.z };\n      const end = { x: tx + 2 * Math.PI, y: ty + 2 * Math.PI, z: tz + 2 * Math.PI };\n\n      // Use GSAP timeline for smooth rotation + bounces and DOM motion\n      const timeline = gsap.timeline({ onComplete: () => {\n        cube.rotation.set(tx, ty, tz);\n        if (onRoll) onRoll(face);\n      }});\n\n      // ensure any previous tweens are cleared and canvas anchored bottom-right\n      const canvasEl = canvasRef.current as HTMLCanvasElement | null;\n      if (canvasEl) {\n        try { gsap.killTweensOf(canvasEl); } catch (e) {}\n        try {\n          canvasEl.style.transform = '';\n          canvasEl.style.transition = '';\n          canvasEl.style.left = '';\n          canvasEl.style.top = '';\n          canvasEl.style.right = '20px';\n          canvasEl.style.bottom = '20px';\n          canvasEl.style.willChange = 'auto';\n        } catch (e) {}\n      }\n\n      if (spinOnly) {\n        // keep canvas fixed bottom-right with no transform\n        if (canvasEl && canvasEl.style) {\n          gsap.set(canvasEl, { x: 0, y: 0, filter: 'blur(0px)' });\n          canvasEl.style.right = '20px';\n          canvasEl.style.bottom = '20px';\n        }\n      } else {\n        // physics-like multi-bounce motion across screen\n        if (canvasEl && canvasEl.style) {\n          canvasEl.style.position = 'fixed';\n          canvasEl.style.left = '0px';\n          canvasEl.style.top = '0px';\n          canvasEl.style.willChange = 'transform, filter';\n\n          // initial velocity and angle\n          const speedBase = Math.max(200, duration * 0.6); // px per second scale\n          const angle = Math.random() * Math.PI * 2;\n          let vx = Math.cos(angle) * (speedBase * (0.6 + Math.random() * 0.8));\n          let vy = Math.sin(angle) * (speedBase * (0.6 + Math.random() * 0.8));\n\n          // start position: bottom-right corner with small margin\n          const margin = 20;\n          const startX = Math.max(0, window.innerWidth - size - margin);\n          const startY = Math.max(0, window.innerHeight - size - margin);\n          let x = startX;\n          let y = startY;\n          gsap.set(canvasEl, { x, y, filter: 'blur(0px)' });\n\n          // final target: within 100px radius around screen center\n          const centerX = Math.round(window.innerWidth / 2 - size / 2);\n          const centerY = Math.round(window.innerHeight / 2 - size / 2);\n          const radius = 100;\n          const angT = Math.random() * Math.PI * 2;\n          const endX = Math.max(0, Math.min(window.innerWidth - size, centerX + Math.cos(angT) * (Math.random() * radius)));\n          const endY = Math.max(0, Math.min(window.innerHeight - size, centerY + Math.sin(angT) * (Math.random() * radius)));\n\n          // generate bounces until energy low or max 6 bounces\n          const bounces: Array<{ nx: number; ny: number; dur: number; blur: number }> = [];\n          let energy = Math.hypot(vx, vy);\n          const damp = 0.45 + Math.random() * 0.18; // energy retention per bounce\n          const maxBounces = 6;\n          for (let i = 0; i < maxBounces && energy > 80; i++) {\n            // project next position with simple friction\n            const dt = (duration / 1000) * (0.25 + Math.random() * 0.35);\n            const nx = x + vx * dt;\n            const ny = y + vy * dt + 200 * (Math.random() - 0.5) * 0.1; // slight gravity variation\n            const dur = Math.max(0.06, dt * (0.6 + Math.random() * 0.6));\n            const blur = Math.min(6, energy / 200);\n            bounces.push({ nx, ny, dur, blur });\n\n            // update for next\n            x = nx; y = ny;\n            energy *= damp * (0.8 + Math.random() * 0.4);\n            // random angle change\n            const angChange = (Math.random() - 0.5) * 0.8;\n            const vAngle = Math.atan2(vy, vx) + angChange;\n            const vMag = energy;\n            vx = Math.cos(vAngle) * vMag * 0.02;\n            vy = Math.sin(vAngle) * vMag * 0.02;\n          }\n\n          // schedule bounces in timeline\n          let tOffset = 0;\n          for (const b of bounces) {\n            timeline.to(canvasEl, { duration: b.dur, x: b.nx, y: b.ny, ease: 'power2.out' }, tOffset);\n            timeline.to(canvasEl, { duration: b.dur, filter: `blur(${b.blur}px)` }, tOffset);\n            tOffset += b.dur * 0.9;\n          }\n          // final settle to the computed center-target\n          timeline.to(canvasEl, { duration: 0.12, x: endX, y: endY, ease: 'power1.out' }, '>-0.02');\n          timeline.to(canvasEl, { duration: 0.12, filter: 'blur(0px)', ease: 'power1.out' }, '>-0.02');\n        }\n      }\n\n      // rotation: spin multiple revolutions then ease to final orientation\n      // we'll use a GSAP ticker to update cube.rotation\n      const totalSpins = 3 + Math.floor(Math.random() * 4);\n      const rotEnd = { x: end.x, y: end.y, z: end.z };\n      const rotStart = { x: start.x, y: start.y, z: start.z };\n\n      // animate rotation using timeline with an onUpdate that writes to cube\n      let progress = { t: 0 };\n      timeline.to(progress, {\n        t: 1,\n        duration: duration / 1000,\n        ease: 'power3.out',\n        onUpdate: () => {\n          const k = progress.t;\n          // combine ease with extra spins\n          const spinFactor = 1 - Math.pow(1 - k, 3);\n          const currentX = rotStart.x + (rotEnd.x - rotStart.x) * k + totalSpins * Math.PI * 2 * (1 - (1 - k));\n          const currentY = rotStart.y + (rotEnd.y - rotStart.y) * k + totalSpins * Math.PI * 2 * (1 - (1 - k));\n          const currentZ = rotStart.z + (rotEnd.z - rotStart.z) * k + totalSpins * Math.PI * 2 * (1 - (1 - k));\n          cube.rotation.set(currentX, currentY, currentZ);\n        }\n      });\n\n      // small multi-bounce sequence on completion (scale + tilt)\n      timeline.to(cube.scale, { x: 1.08, y: 0.90, z: 0.9, duration: 0.07, ease: 'power2.out' }, '>-0.05');\n      timeline.to(cube.scale, { x: 0.95, y: 1.07, z: 0.95, duration: 0.06, ease: 'power2.in' });\n      timeline.to(cube.scale, { x: 1.03, y: 0.98, z: 1.02, duration: 0.05, ease: 'power2.out' });\n      timeline.to(cube.scale, { x: 1, y: 1, z: 1, duration: 0.04, ease: 'power2.out' });\n    };\n\n    useImperativeHandle(ref, () => ({\n      roll: () => rollInternal(),\n      rollTo: (face: number) => rollInternal(Math.max(1, Math.min(6, face))),\n    }), [duration, onRoll]);\n\n    // click to roll\n    useEffect(() => {\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      const handler = () => rollInternal();\n      canvas.addEventListener('click', handler);\n      return () => canvas.removeEventListener('click', handler);\n    }, []);\n\n    return <canvas ref={canvasRef} width={size} height={size} className={className} style={{ cursor: 'pointer' }} />;\n  });\n\nexport default Dice3D;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}