{"ast":null,"code":"function other(p) {\n  return p === 1 ? 2 : 1;\n}\nexport function startOfTurn(state, p) {\n  var _state$board$p$innen, _state$board$p, _state$board$p$aussen, _state$board$p2;\n  // AP reset\n  state.actionPoints[p] = 2;\n\n  // Flags reset\n  const f = state.effectFlags[p];\n  // Flags reset\n  const prevZuck = f.zuckSpent;\n  f.zuckOnceAp = false;\n  f.zuckSpent = false;\n  f.aiWeiweiOnActivate = false;\n  f.elonOnceAp = false;\n  f.auraScience = 0;\n  f.auraHealth = 0;\n  f.auraMilitaryPenalty = 0;\n  // Oppositionsblockade ends at start of player's turn\n  f.initiativesLocked = false;\n  // Simplified AP system: No initiative-specific bonuses\n\n  // Helper to consume double aura flag once\n  const consumeDouble = () => {\n    if (f.doublePublicAura) {\n      f.doublePublicAura = false;\n      if (!state._effectQueue) state._effectQueue = [];\n      state._effectQueue.push({\n        type: 'LOG',\n        msg: 'Double Public Aura consumed.'\n      });\n      return true;\n    }\n    return false;\n  };\n\n  // Determine active public cards (inner lane)\n  const pubNames = ((_state$board$p$innen = (_state$board$p = state.board[p]) === null || _state$board$p === void 0 ? void 0 : _state$board$p.innen) !== null && _state$board$p$innen !== void 0 ? _state$board$p$innen : []).map(c => c.name);\n\n  // Apply auras with possible doubling (consume order defined)\n  if (pubNames.includes('Jennifer Doudna')) {\n    var _f$auraScience;\n    const doubled = consumeDouble();\n    f.auraScience = ((_f$auraScience = f.auraScience) !== null && _f$auraScience !== void 0 ? _f$auraScience : 0) + (doubled ? 2 : 1);\n  }\n  if (pubNames.includes('Anthony Fauci')) {\n    var _f$auraHealth;\n    const doubled = consumeDouble();\n    f.auraHealth = ((_f$auraHealth = f.auraHealth) !== null && _f$auraHealth !== void 0 ? _f$auraHealth : 0) + (doubled ? 2 : 1);\n  }\n  if (pubNames.includes('Noam Chomsky')) {\n    var _f$auraMilitaryPenalt;\n    const doubled = consumeDouble();\n    f.auraMilitaryPenalty = ((_f$auraMilitaryPenalt = f.auraMilitaryPenalty) !== null && _f$auraMilitaryPenalt !== void 0 ? _f$auraMilitaryPenalt : 0) + (doubled ? 2 : 1);\n  }\n\n  // einmalige Aktivierungsboni\n  if (pubNames.includes('Mark Zuckerberg')) f.zuckOnceAp = true;\n  if (pubNames.includes('Ai Weiwei')) f.aiWeiweiOnActivate = true;\n  if (pubNames.includes('Elon Musk')) f.elonOnceAp = true;\n\n  // Leadership effect: +1 AP immediately\n  const govNames = ((_state$board$p$aussen = (_state$board$p2 = state.board[p]) === null || _state$board$p2 === void 0 ? void 0 : _state$board$p2.aussen) !== null && _state$board$p$aussen !== void 0 ? _state$board$p$aussen : []).map(c => c.name);\n  if (govNames.some(name => ['Justin Trudeau', 'Volodymyr Zelenskyy', 'Ursula von der Leyen', 'Donald Trump', 'Mohammed bin Salman', 'Benjamin Netanyahu', 'Helmut Schmidt'].includes(name))) {\n    // Simplified AP system: Leadership gives +1 AP immediately\n    state.actionPoints[p] += 1;\n  }\n}\n\n// Legacy compatibility\nexport function applyStartOfTurnFlags(state, player, log) {\n  startOfTurn(state, player);\n}\nexport function applyStartOfTurnHooks(state, player, log) {\n  applyStartOfTurnFlags(state, player, log);\n}","map":{"version":3,"names":["other","p","startOfTurn","state","_state$board$p$innen","_state$board$p","_state$board$p$aussen","_state$board$p2","actionPoints","f","effectFlags","prevZuck","zuckSpent","zuckOnceAp","aiWeiweiOnActivate","elonOnceAp","auraScience","auraHealth","auraMilitaryPenalty","initiativesLocked","consumeDouble","doublePublicAura","_effectQueue","push","type","msg","pubNames","board","innen","map","c","name","includes","_f$auraScience","doubled","_f$auraHealth","_f$auraMilitaryPenalt","govNames","aussen","some","applyStartOfTurnFlags","player","log","applyStartOfTurnHooks"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/utils/startOfTurnHooks.ts"],"sourcesContent":["import { GameState, Player } from '../types/game';\r\n\r\nfunction other(p: Player): Player { return p === 1 ? 2 : 1; }\r\n\r\nexport function startOfTurn(state: GameState, p: Player) {\r\n  // AP reset\r\n  state.actionPoints[p] = 2;\r\n\r\n  // Flags reset\r\n  const f = state.effectFlags[p];\r\n  // Flags reset\r\n  const prevZuck = f.zuckSpent;\r\n  f.zuckOnceAp = false;\r\n  f.zuckSpent = false;\r\n  f.aiWeiweiOnActivate = false;\r\n  f.elonOnceAp = false;\r\n  f.auraScience = 0;\r\n  f.auraHealth = 0;\r\n  f.auraMilitaryPenalty = 0;\r\n  // Oppositionsblockade ends at start of player's turn\r\n  f.initiativesLocked = false;\r\n  // Simplified AP system: No initiative-specific bonuses\r\n\r\n  // Helper to consume double aura flag once\r\n  const consumeDouble = (): boolean => {\r\n    if (f.doublePublicAura) {\r\n      f.doublePublicAura = false;\r\n      if (!state._effectQueue) state._effectQueue = [];\r\n      state._effectQueue.push({ type: 'LOG', msg: 'Double Public Aura consumed.' } as any);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // Determine active public cards (inner lane)\r\n  const pubNames: string[] = (state.board[p]?.innen ?? []).map(c => c.name);\r\n\r\n  // Apply auras with possible doubling (consume order defined)\r\n  if (pubNames.includes('Jennifer Doudna')) {\r\n    const doubled = consumeDouble();\r\n    f.auraScience = (f.auraScience ?? 0) + (doubled ? 2 : 1);\r\n  }\r\n  if (pubNames.includes('Anthony Fauci')) {\r\n    const doubled = consumeDouble();\r\n    f.auraHealth = (f.auraHealth ?? 0) + (doubled ? 2 : 1);\r\n  }\r\n  if (pubNames.includes('Noam Chomsky')) {\r\n    const doubled = consumeDouble();\r\n    f.auraMilitaryPenalty = (f.auraMilitaryPenalty ?? 0) + (doubled ? 2 : 1);\r\n  }\r\n\r\n  // einmalige Aktivierungsboni\r\n  if (pubNames.includes('Mark Zuckerberg')) f.zuckOnceAp = true;\r\n  if (pubNames.includes('Ai Weiwei')) f.aiWeiweiOnActivate = true;\r\n  if (pubNames.includes('Elon Musk')) f.elonOnceAp = true;\r\n\r\n  // Leadership effect: +1 AP immediately\r\n  const govNames: string[] = (state.board[p]?.aussen ?? []).map((c: any) => c.name);\r\n  if (govNames.some(name => ['Justin Trudeau', 'Volodymyr Zelenskyy', 'Ursula von der Leyen', 'Donald Trump', 'Mohammed bin Salman', 'Benjamin Netanyahu', 'Helmut Schmidt'].includes(name))) {\r\n    // Simplified AP system: Leadership gives +1 AP immediately\r\n    state.actionPoints[p] += 1;\r\n  }\r\n}\r\n\r\n// Legacy compatibility\r\nexport function applyStartOfTurnFlags(state: GameState, player: Player, log: (m: string) => void) {\r\n  startOfTurn(state, player);\r\n}\r\n\r\nexport function applyStartOfTurnHooks(state: GameState, player: Player, log: (m: string) => void) {\r\n  applyStartOfTurnFlags(state, player, log);\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}