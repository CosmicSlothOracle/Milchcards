{"ast":null,"code":"function other(p) {\n  return p === 1 ? 2 : 1;\n}\nexport function startOfTurn(state, p) {\n  // Standard-Refresh: 2 AP pro Zug\n  state.actionPoints[p] = 2;\n  state.actionsUsed[p] = 0;\n\n  // Reset pro Runde\n  state.effectFlags[p].initiativeDiscount = 0;\n  state.effectFlags[p].initiativeRefund = 0;\n  state.effectFlags[p].govRefundAvailable = false;\n  state.effectFlags[p].markZuckerbergUsed = false;\n\n  // Cluster-3: temporÃ¤re Auren (namensbasiert, gelten fÃ¼r Sofort-Initiativen)\n  // +1 Einfluss bei Sofort-Initiativen (eigener Spieler):\n  const publicNames = state.board[p].innen.map(c => c.name);\n  const oppPublic = state.board[other(p)].innen.map(c => c.name);\n\n  // Jennifer Doudna / Anthony Fauci  â†’ +1 kumulativ pro Karte\n  const plusSources = ['Jennifer Doudna', 'Anthony Fauci'];\n  const plusCount = publicNames.filter(n => plusSources.includes(n)).length;\n  state.effectFlags[p].initiativeInfluenceBonus = plusCount; // 0..2\n\n  // Noam Chomsky â†’ Gegner bekommt -1 (wir speichern beim Besitzer)\n  state.effectFlags[p].initiativeInfluencePenaltyForOpponent = publicNames.includes('Noam Chomsky') ? 1 : 0;\n\n  // Ai Weiwei â†’ Bei Sofort-Initiative: +1 Karte +1 AP\n  state.effectFlags[p].initiativeOnPlayDraw1Ap1 = publicNames.includes('Ai Weiwei');\n\n  // Bewegung (Greta/Malala) â†’ Government-Refund einmalig\n  const movement = ['Greta Thunberg', 'Malala Yousafzai'];\n  if (publicNames.some(n => movement.includes(n))) {\n    state.effectFlags[p].govRefundAvailable = true;\n  }\n\n  // Fertig geloggt\n  state.log.push(`ðŸ”„ Start Zug P${p}: Auren gesetzt (+${plusCount} | Gegner-Penalty=${state.effectFlags[p].initiativeInfluencePenaltyForOpponent})`);\n}\n\n// Legacy compatibility\nexport function applyStartOfTurnFlags(state, player, log) {\n  startOfTurn(state, player);\n}\nexport function applyStartOfTurnHooks(state, player, log) {\n  applyStartOfTurnFlags(state, player, log);\n}","map":{"version":3,"names":["other","p","startOfTurn","state","actionPoints","actionsUsed","effectFlags","initiativeDiscount","initiativeRefund","govRefundAvailable","markZuckerbergUsed","publicNames","board","innen","map","c","name","oppPublic","plusSources","plusCount","filter","n","includes","length","initiativeInfluenceBonus","initiativeInfluencePenaltyForOpponent","initiativeOnPlayDraw1Ap1","movement","some","log","push","applyStartOfTurnFlags","player","applyStartOfTurnHooks"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/utils/startOfTurnHooks.ts"],"sourcesContent":["import { GameState, Player } from '../types/game';\r\n\r\nfunction other(p: Player): Player { return p === 1 ? 2 : 1; }\r\n\r\nexport function startOfTurn(state: GameState, p: Player) {\r\n  // Standard-Refresh: 2 AP pro Zug\r\n  state.actionPoints[p] = 2;\r\n  state.actionsUsed[p] = 0;\r\n\r\n  // Reset pro Runde\r\n  state.effectFlags[p].initiativeDiscount = 0;\r\n  state.effectFlags[p].initiativeRefund = 0;\r\n  state.effectFlags[p].govRefundAvailable = false;\r\n  state.effectFlags[p].markZuckerbergUsed = false;\r\n\r\n  // Cluster-3: temporÃ¤re Auren (namensbasiert, gelten fÃ¼r Sofort-Initiativen)\r\n  // +1 Einfluss bei Sofort-Initiativen (eigener Spieler):\r\n  const publicNames = state.board[p].innen.map(c => c.name);\r\n  const oppPublic   = state.board[other(p)].innen.map(c => c.name);\r\n\r\n  // Jennifer Doudna / Anthony Fauci  â†’ +1 kumulativ pro Karte\r\n  const plusSources = ['Jennifer Doudna', 'Anthony Fauci'];\r\n  const plusCount   = publicNames.filter(n => plusSources.includes(n)).length;\r\n  state.effectFlags[p].initiativeInfluenceBonus = plusCount; // 0..2\r\n\r\n  // Noam Chomsky â†’ Gegner bekommt -1 (wir speichern beim Besitzer)\r\n  state.effectFlags[p].initiativeInfluencePenaltyForOpponent =\r\n    publicNames.includes('Noam Chomsky') ? 1 : 0;\r\n\r\n  // Ai Weiwei â†’ Bei Sofort-Initiative: +1 Karte +1 AP\r\n  state.effectFlags[p].initiativeOnPlayDraw1Ap1 =\r\n    publicNames.includes('Ai Weiwei');\r\n\r\n  // Bewegung (Greta/Malala) â†’ Government-Refund einmalig\r\n  const movement = ['Greta Thunberg', 'Malala Yousafzai'];\r\n  if (publicNames.some(n => movement.includes(n))) {\r\n    state.effectFlags[p].govRefundAvailable = true;\r\n  }\r\n\r\n  // Fertig geloggt\r\n  state.log.push(`ðŸ”„ Start Zug P${p}: Auren gesetzt (+${plusCount} | Gegner-Penalty=${state.effectFlags[p].initiativeInfluencePenaltyForOpponent})`);\r\n}\r\n\r\n// Legacy compatibility\r\nexport function applyStartOfTurnFlags(state: GameState, player: Player, log: (m: string) => void) {\r\n  startOfTurn(state, player);\r\n}\r\n\r\nexport function applyStartOfTurnHooks(state: GameState, player: Player, log: (m: string) => void) {\r\n  applyStartOfTurnFlags(state, player, log);\r\n}"],"mappings":"AAEA,SAASA,KAAKA,CAACC,CAAS,EAAU;EAAE,OAAOA,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC;AAAE;AAE5D,OAAO,SAASC,WAAWA,CAACC,KAAgB,EAAEF,CAAS,EAAE;EACvD;EACAE,KAAK,CAACC,YAAY,CAACH,CAAC,CAAC,GAAG,CAAC;EACzBE,KAAK,CAACE,WAAW,CAACJ,CAAC,CAAC,GAAG,CAAC;;EAExB;EACAE,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACM,kBAAkB,GAAG,CAAC;EAC3CJ,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACO,gBAAgB,GAAG,CAAC;EACzCL,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACQ,kBAAkB,GAAG,KAAK;EAC/CN,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACS,kBAAkB,GAAG,KAAK;;EAE/C;EACA;EACA,MAAMC,WAAW,GAAGR,KAAK,CAACS,KAAK,CAACX,CAAC,CAAC,CAACY,KAAK,CAACC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC;EACzD,MAAMC,SAAS,GAAKd,KAAK,CAACS,KAAK,CAACZ,KAAK,CAACC,CAAC,CAAC,CAAC,CAACY,KAAK,CAACC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC;;EAEhE;EACA,MAAME,WAAW,GAAG,CAAC,iBAAiB,EAAE,eAAe,CAAC;EACxD,MAAMC,SAAS,GAAKR,WAAW,CAACS,MAAM,CAACC,CAAC,IAAIH,WAAW,CAACI,QAAQ,CAACD,CAAC,CAAC,CAAC,CAACE,MAAM;EAC3EpB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACuB,wBAAwB,GAAGL,SAAS,CAAC,CAAC;;EAE3D;EACAhB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACwB,qCAAqC,GACxDd,WAAW,CAACW,QAAQ,CAAC,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC;;EAE9C;EACAnB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACyB,wBAAwB,GAC3Cf,WAAW,CAACW,QAAQ,CAAC,WAAW,CAAC;;EAEnC;EACA,MAAMK,QAAQ,GAAG,CAAC,gBAAgB,EAAE,kBAAkB,CAAC;EACvD,IAAIhB,WAAW,CAACiB,IAAI,CAACP,CAAC,IAAIM,QAAQ,CAACL,QAAQ,CAACD,CAAC,CAAC,CAAC,EAAE;IAC/ClB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACQ,kBAAkB,GAAG,IAAI;EAChD;;EAEA;EACAN,KAAK,CAAC0B,GAAG,CAACC,IAAI,CAAC,iBAAiB7B,CAAC,qBAAqBkB,SAAS,qBAAqBhB,KAAK,CAACG,WAAW,CAACL,CAAC,CAAC,CAACwB,qCAAqC,GAAG,CAAC;AACpJ;;AAEA;AACA,OAAO,SAASM,qBAAqBA,CAAC5B,KAAgB,EAAE6B,MAAc,EAAEH,GAAwB,EAAE;EAChG3B,WAAW,CAACC,KAAK,EAAE6B,MAAM,CAAC;AAC5B;AAEA,OAAO,SAASC,qBAAqBA,CAAC9B,KAAgB,EAAE6B,MAAc,EAAEH,GAAwB,EAAE;EAChGE,qBAAqB,CAAC5B,KAAK,EAAE6B,MAAM,EAAEH,GAAG,CAAC;AAC3C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}