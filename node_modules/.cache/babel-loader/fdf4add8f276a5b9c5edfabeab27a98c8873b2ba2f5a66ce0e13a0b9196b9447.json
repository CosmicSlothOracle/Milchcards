{"ast":null,"code":"function other(p) {\n  return p === 1 ? 2 : 1;\n}\nexport function startOfTurn(state, p) {\n  var _state$board$p$innen, _state$board$p, _state$board$p$aussen, _state$board$p2;\n  // AP reset\n  state.actionPoints[p] = 2;\n\n  // Flags reset\n  const f = state.effectFlags[p];\n  // Flags reset\n  const prevZuck = f.zuckSpent;\n  f.zuckOnceAp = false;\n  f.zuckSpent = false;\n  f.aiWeiweiOnActivate = false;\n  f.elonOnceAp = false;\n  f.elonOnActivate = false;\n  f.auraScience = 0;\n  f.auraHealth = 0;\n  f.auraMilitaryPenalty = 0;\n  // Oppositionsblockade ends at start of player's turn\n  f.initiativesLocked = false;\n  // Simplified AP system: No initiative-specific bonuses\n\n  // Helper to consume double aura flag once\n  const consumeDouble = () => {\n    if (f.doublePublicAura) {\n      f.doublePublicAura = false;\n      if (!state._effectQueue) state._effectQueue = [];\n      state._effectQueue.push({\n        type: 'LOG',\n        msg: 'Double Public Aura consumed.'\n      });\n      return true;\n    }\n    return false;\n  };\n\n  // Determine active public cards (inner lane)\n  const pubNames = ((_state$board$p$innen = (_state$board$p = state.board[p]) === null || _state$board$p === void 0 ? void 0 : _state$board$p.innen) !== null && _state$board$p$innen !== void 0 ? _state$board$p$innen : []).map(c => c.name);\n\n  // Apply auras via events instead of direct state mutation\n  if (pubNames.includes('Jennifer Doudna')) {\n    const doubled = consumeDouble();\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({\n      type: 'LOG',\n      msg: `Jennifer Doudna: Science aura ${doubled ? '+2' : '+1'} activated.`\n    });\n  }\n  if (pubNames.includes('Anthony Fauci')) {\n    const doubled = consumeDouble();\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({\n      type: 'LOG',\n      msg: `Anthony Fauci: Health aura ${doubled ? '+2' : '+1'} activated.`\n    });\n  }\n  if (pubNames.includes('Noam Chomsky')) {\n    const doubled = consumeDouble();\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({\n      type: 'LOG',\n      msg: `Noam Chomsky: Military penalty aura ${doubled ? '+2' : '+1'} activated.`\n    });\n  }\n\n  // Activation bonuses via events\n  if (pubNames.includes('Mark Zuckerberg')) {\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({\n      type: 'LOG',\n      msg: 'Mark Zuckerberg: +1 AP on next initiative activation.'\n    });\n  }\n  if (pubNames.includes('Ai Weiwei')) {\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({\n      type: 'LOG',\n      msg: 'Ai Weiwei: +1 card +1 AP on next initiative activation.'\n    });\n  }\n\n  // Leadership effect: +1 AP immediately\n  const govNames = ((_state$board$p$aussen = (_state$board$p2 = state.board[p]) === null || _state$board$p2 === void 0 ? void 0 : _state$board$p2.aussen) !== null && _state$board$p$aussen !== void 0 ? _state$board$p$aussen : []).map(c => c.name);\n  if (govNames.some(name => ['Justin Trudeau', 'Volodymyr Zelenskyy', 'Ursula von der Leyen', 'Donald Trump', 'Mohammed bin Salman', 'Benjamin Netanyahu', 'Helmut Schmidt'].includes(name))) {\n    // Simplified AP system: Leadership gives +1 AP immediately\n    state.actionPoints[p] += 1;\n  }\n}\n\n// Legacy compatibility\nexport function applyStartOfTurnFlags(state, player, log) {\n  startOfTurn(state, player);\n}\nexport function applyStartOfTurnHooks(state, player, log) {\n  applyStartOfTurnFlags(state, player, log);\n}","map":{"version":3,"names":["other","p","startOfTurn","state","_state$board$p$innen","_state$board$p","_state$board$p$aussen","_state$board$p2","actionPoints","f","effectFlags","prevZuck","zuckSpent","zuckOnceAp","aiWeiweiOnActivate","elonOnceAp","elonOnActivate","auraScience","auraHealth","auraMilitaryPenalty","initiativesLocked","consumeDouble","doublePublicAura","_effectQueue","push","type","msg","pubNames","board","innen","map","c","name","includes","doubled","govNames","aussen","some","applyStartOfTurnFlags","player","log","applyStartOfTurnHooks"],"sources":["C:/Users/skank/Videos/Cards/Milchcards/src/utils/startOfTurnHooks.ts"],"sourcesContent":["import { GameState, Player } from '../types/game';\n\nfunction other(p: Player): Player { return p === 1 ? 2 : 1; }\n\nexport function startOfTurn(state: GameState, p: Player) {\n  // AP reset\n  state.actionPoints[p] = 2;\n\n  // Flags reset\n  const f = state.effectFlags[p];\n  // Flags reset\n  const prevZuck = f.zuckSpent;\n  f.zuckOnceAp = false;\n  f.zuckSpent = false;\n  f.aiWeiweiOnActivate = false;\n  f.elonOnceAp = false;\n  f.elonOnActivate = false;\n  f.auraScience = 0;\n  f.auraHealth = 0;\n  f.auraMilitaryPenalty = 0;\n  // Oppositionsblockade ends at start of player's turn\n  f.initiativesLocked = false;\n  // Simplified AP system: No initiative-specific bonuses\n\n  // Helper to consume double aura flag once\n  const consumeDouble = (): boolean => {\n    if (f.doublePublicAura) {\n      f.doublePublicAura = false;\n      if (!state._effectQueue) state._effectQueue = [];\n      state._effectQueue.push({ type: 'LOG', msg: 'Double Public Aura consumed.' } as any);\n      return true;\n    }\n    return false;\n  };\n\n  // Determine active public cards (inner lane)\n  const pubNames: string[] = (state.board[p]?.innen ?? []).map(c => c.name);\n\n  // Apply auras via events instead of direct state mutation\n  if (pubNames.includes('Jennifer Doudna')) {\n    const doubled = consumeDouble();\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({ type: 'LOG', msg: `Jennifer Doudna: Science aura ${doubled ? '+2' : '+1'} activated.` } as any);\n  }\n  if (pubNames.includes('Anthony Fauci')) {\n    const doubled = consumeDouble();\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({ type: 'LOG', msg: `Anthony Fauci: Health aura ${doubled ? '+2' : '+1'} activated.` } as any);\n  }\n  if (pubNames.includes('Noam Chomsky')) {\n    const doubled = consumeDouble();\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({ type: 'LOG', msg: `Noam Chomsky: Military penalty aura ${doubled ? '+2' : '+1'} activated.` } as any);\n  }\n\n  // Activation bonuses via events\n  if (pubNames.includes('Mark Zuckerberg')) {\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({ type: 'LOG', msg: 'Mark Zuckerberg: +1 AP on next initiative activation.' } as any);\n  }\n  if (pubNames.includes('Ai Weiwei')) {\n    if (!state._effectQueue) state._effectQueue = [];\n    state._effectQueue.push({ type: 'LOG', msg: 'Ai Weiwei: +1 card +1 AP on next initiative activation.' } as any);\n  }\n\n  // Leadership effect: +1 AP immediately\n  const govNames: string[] = (state.board[p]?.aussen ?? []).map((c: any) => c.name);\n  if (govNames.some(name => ['Justin Trudeau', 'Volodymyr Zelenskyy', 'Ursula von der Leyen', 'Donald Trump', 'Mohammed bin Salman', 'Benjamin Netanyahu', 'Helmut Schmidt'].includes(name))) {\n    // Simplified AP system: Leadership gives +1 AP immediately\n    state.actionPoints[p] += 1;\n  }\n}\n\n// Legacy compatibility\nexport function applyStartOfTurnFlags(state: GameState, player: Player, log: (m: string) => void) {\n  startOfTurn(state, player);\n}\n\nexport function applyStartOfTurnHooks(state: GameState, player: Player, log: (m: string) => void) {\n  applyStartOfTurnFlags(state, player, log);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}